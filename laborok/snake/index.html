
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Ekler Péter, Gazdi László, Kövesdán Gábor, Pásztor Dániel, Pomázi Krisztián">
      
      
      
        <link rel="prev" href="../../tudnivalok/github/contributing/">
      
      
        <link rel="next" href="../news/">
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.14">
    
    
      
        <title>Labor 1 - Snake Game - BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="red" data-md-color-accent="red">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#labor-1-snake-game" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../.." title="BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok" class="md-header__button md-logo" aria-label="BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Labor 1 - Snake Game
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
            </label>
          
        
          
          <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent=""  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/viaubxav080/laborok" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    viaubxav080/laborok
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Tudnivalók
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="./" class="md-tabs__link md-tabs__link--active">
        Laborok
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../hf/" class="md-tabs__link">
        Házi feladat
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok" class="md-nav__button md-logo" aria-label="BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUBXAV080 - Haladó Android fejlesztés laborfeladatok
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/viaubxav080/laborok" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    viaubxav080/laborok
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Tudnivalók
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Tudnivalók
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Tárgy ismertető
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub/" class="md-nav__link">
        Feladatok beadása (GitHub)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub-Actions/" class="md-nav__link">
        GitHub Actions ismertető
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/GitHub-credentials/" class="md-nav__link">
        Egyetemi laborokban: GitHub belépés
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../tudnivalok/github/contributing/" class="md-nav__link">
        Hozzájárulás az anyaghoz
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Laborok
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Laborok
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Labor 1 - Snake Game
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Labor 1 - Snake Game
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elokeszuletek" class="md-nav__link">
    Előkészületek
  </a>
  
    <nav class="md-nav" aria-label="Előkészületek">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository-letrehozasa-es-letoltese" class="md-nav__link">
    Git repository létrehozása és letöltése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projekt-letrehozasa" class="md-nav__link">
    Projekt létrehozása
  </a>
  
    <nav class="md-nav" aria-label="Projekt létrehozása">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eroforrasok-letoltese" class="md-nav__link">
    Erőforrások letöltése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navigacio-a-kepernyok-kozott-25-pont" class="md-nav__link">
    Navigáció a képernyők között (2.5 pont)
  </a>
  
    <nav class="md-nav" aria-label="Navigáció a képernyők között (2.5 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-screen" class="md-nav__link">
    Main Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settings-screen" class="md-nav__link">
    Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-scores-screen" class="md-nav__link">
    High Scores Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-settings-screen" class="md-nav__link">
    Game Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-screen" class="md-nav__link">
    Game Screen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kepernyok-kiegeszitese-25-pont" class="md-nav__link">
    Képernyők kiegészítése (2.5 pont)
  </a>
  
    <nav class="md-nav" aria-label="Képernyők kiegészítése (2.5 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings-screen_1" class="md-nav__link">
    Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-scores-screen_1" class="md-nav__link">
    High Scores Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-settings-screen_1" class="md-nav__link">
    Game Settings Screen
  </a>
  
    <nav class="md-nav" aria-label="Game Settings Screen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-mode-map" class="md-nav__link">
    Game Mode Map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-label" class="md-nav__link">
    Difficulty Label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-slider" class="md-nav__link">
    Difficulty Slider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name-field" class="md-nav__link">
    Name Field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-button" class="md-nav__link">
    Start Button
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snake-state-snake-view-model-4-pont" class="md-nav__link">
    Snake State / Snake View Model (4 pont)
  </a>
  
    <nav class="md-nav" aria-label="Snake State / Snake View Model (4 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snake-state" class="md-nav__link">
    Snake State
  </a>
  
    <nav class="md-nav" aria-label="Snake State">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-food" class="md-nav__link">
    Generate Food
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordinate-data-class" class="md-nav__link">
    Coordinate Data Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-state-direction-enum-class" class="md-nav__link">
    Game State / Direction Enum Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-state-fuggveny" class="md-nav__link">
    Get State függvény
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-model" class="md-nav__link">
    View Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#game-screen-drawscope-fuggvenyek-4-pont" class="md-nav__link">
    Game Screen / DrawScope függvények (4 pont)
  </a>
  
    <nav class="md-nav" aria-label="Game Screen / DrawScope függvények (4 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#body-image" class="md-nav__link">
    Body Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isturn" class="md-nav__link">
    isTurn
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-scores-database-2-pont" class="md-nav__link">
    High Scores / Database (2 pont)
  </a>
  
    <nav class="md-nav" aria-label="High Scores / Database (2 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dao" class="md-nav__link">
    Dao
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity" class="md-nav__link">
    Entity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" class="md-nav__link">
    DataBase
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensor-control-2-pont" class="md-nav__link">
    Sensor Control (2 pont)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onallo-feladat-3-pont" class="md-nav__link">
    Önálló feladat (3 pont)
  </a>
  
    <nav class="md-nav" aria-label="Önálló feladat (3 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-score-delete-all-megvalositasa-1-pont" class="md-nav__link">
    High Score Delete All megvalósítása (1 pont)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isturned-megvalositasa-1-pont" class="md-nav__link">
    isTurned megvalósítása (1 pont)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egyetlen-elem-torlese-1-pont" class="md-nav__link">
    Egyetlen elem törlése (1 pont)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../news/" class="md-nav__link">
        Labor 2 - News
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Házi feladat
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Házi feladat
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hf/" class="md-nav__link">
        Házi feladat információk
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elokeszuletek" class="md-nav__link">
    Előkészületek
  </a>
  
    <nav class="md-nav" aria-label="Előkészületek">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository-letrehozasa-es-letoltese" class="md-nav__link">
    Git repository létrehozása és letöltése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#projekt-letrehozasa" class="md-nav__link">
    Projekt létrehozása
  </a>
  
    <nav class="md-nav" aria-label="Projekt létrehozása">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eroforrasok-letoltese" class="md-nav__link">
    Erőforrások letöltése
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navigacio-a-kepernyok-kozott-25-pont" class="md-nav__link">
    Navigáció a képernyők között (2.5 pont)
  </a>
  
    <nav class="md-nav" aria-label="Navigáció a képernyők között (2.5 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-screen" class="md-nav__link">
    Main Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#settings-screen" class="md-nav__link">
    Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-scores-screen" class="md-nav__link">
    High Scores Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-settings-screen" class="md-nav__link">
    Game Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-screen" class="md-nav__link">
    Game Screen
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kepernyok-kiegeszitese-25-pont" class="md-nav__link">
    Képernyők kiegészítése (2.5 pont)
  </a>
  
    <nav class="md-nav" aria-label="Képernyők kiegészítése (2.5 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings-screen_1" class="md-nav__link">
    Settings Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#high-scores-screen_1" class="md-nav__link">
    High Scores Screen
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-settings-screen_1" class="md-nav__link">
    Game Settings Screen
  </a>
  
    <nav class="md-nav" aria-label="Game Settings Screen">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#game-mode-map" class="md-nav__link">
    Game Mode Map
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-label" class="md-nav__link">
    Difficulty Label
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#difficulty-slider" class="md-nav__link">
    Difficulty Slider
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#name-field" class="md-nav__link">
    Name Field
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#start-button" class="md-nav__link">
    Start Button
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snake-state-snake-view-model-4-pont" class="md-nav__link">
    Snake State / Snake View Model (4 pont)
  </a>
  
    <nav class="md-nav" aria-label="Snake State / Snake View Model (4 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snake-state" class="md-nav__link">
    Snake State
  </a>
  
    <nav class="md-nav" aria-label="Snake State">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#generate-food" class="md-nav__link">
    Generate Food
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#coordinate-data-class" class="md-nav__link">
    Coordinate Data Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#game-state-direction-enum-class" class="md-nav__link">
    Game State / Direction Enum Class
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-state-fuggveny" class="md-nav__link">
    Get State függvény
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#view-model" class="md-nav__link">
    View Model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#game-screen-drawscope-fuggvenyek-4-pont" class="md-nav__link">
    Game Screen / DrawScope függvények (4 pont)
  </a>
  
    <nav class="md-nav" aria-label="Game Screen / DrawScope függvények (4 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#body-image" class="md-nav__link">
    Body Image
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isturn" class="md-nav__link">
    isTurn
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#high-scores-database-2-pont" class="md-nav__link">
    High Scores / Database (2 pont)
  </a>
  
    <nav class="md-nav" aria-label="High Scores / Database (2 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dao" class="md-nav__link">
    Dao
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#entity" class="md-nav__link">
    Entity
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#database" class="md-nav__link">
    DataBase
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensor-control-2-pont" class="md-nav__link">
    Sensor Control (2 pont)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#onallo-feladat-3-pont" class="md-nav__link">
    Önálló feladat (3 pont)
  </a>
  
    <nav class="md-nav" aria-label="Önálló feladat (3 pont)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#high-score-delete-all-megvalositasa-1-pont" class="md-nav__link">
    High Score Delete All megvalósítása (1 pont)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#isturned-megvalositasa-1-pont" class="md-nav__link">
    isTurned megvalósítása (1 pont)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#egyetlen-elem-torlese-1-pont" class="md-nav__link">
    Egyetlen elem törlése (1 pont)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="labor-1-snake-game">Labor 1 - Snake Game<a class="headerlink" href="#labor-1-snake-game" title="Permanent link">&para;</a></h1>
<p>Az első labor folyamán egy összetettebb alkalmazást, játékot fogunk megcsinálni. Ez a játék a Snake játék egy változata lesz. A játék lényege, hogy egy fix méretű pályán egy kígyót kell irányítani, és minél több pontot összeszedni. Ezt az almák felvételével tudjuk elérni. Minden egyes alma felvétele egy egységgel fogja növelni a kígyó hosszát. A szokásos működéstől kicsit eltérő lesz a mi alkalmazásunk, itt 3 nehézség közül lehet majd választani (Easy, Normal, Hard), amelynek köszönhetően fix sebességű lesz a kígyó gyorsasága.</p>
<p>A feladat során az alábbi technológiákkal fogunk találkozni:</p>
<ul>
<li>ViewModel</li>
<li>Dependency Injection</li>
<li>DataStore</li>
<li>Sensor</li>
<li>NavHost</li>
</ul>
<p align="center">
<a class="glightbox" href="./assets/mainscreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/mainscreen.png" width="320"></a>
<a class="glightbox" href="./assets/settingsscreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/settingsscreen.png" width="320"></a>
<a class="glightbox" href="./assets/highscorescreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/highscorescreen.png" width="320"></a>
<a class="glightbox" href="./assets/gamesettingsscreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/gamesettingsscreen.png" width="320"></a>
<a class="glightbox" href="./assets/gamescreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/gamescreen.png" width="320"></a>
<a class="glightbox" href="./assets/gamescreensensor.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/gamescreensensor.png" width="320"></a>
</p>

<p>A játéknak két fajta irányítási lehetősége lesz. Az egyik a nyilakkal lesz elvégezhető, a másik pedig a telefon döntögetésével. Ezt a Sensor osztállyal fogjuk megvalósítani.</p>
<h2 id="elokeszuletek">Előkészületek<a class="headerlink" href="#elokeszuletek" title="Permanent link">&para;</a></h2>
<p>A feladatok megoldása során ne felejtsd el követni a <a href="../../tudnivalok/github/GitHub">feladat beadása folyamatát</a>.</p>
<h3 id="git-repository-letrehozasa-es-letoltese">Git repository létrehozása és letöltése<a class="headerlink" href="#git-repository-letrehozasa-es-letoltese" title="Permanent link">&para;</a></h3>
<ol>
<li>
<p>Moodle-ben keresd meg a laborhoz tartozó meghívó URL-jét és annak segítségével hozd létre a saját repository-dat.</p>
</li>
<li>
<p>Várd meg, míg elkészül a repository, majd checkout-old ki.</p>
<div class="admonition tip">
<p>Egyetemi laborokban, ha a checkout során nem kér a rendszer felhasználónevet és jelszót, és nem sikerül a checkout, akkor valószínűleg a gépen korábban megjegyzett felhasználónévvel próbálkozott a rendszer. Először töröld ki a mentett belépési adatokat (lásd <a href="../../tudnivalok/github/GitHub-credentials/">itt</a>), és próbáld újra.</p>
</div>
</li>
<li>
<p>Hozz létre egy új ágat <code>megoldas</code> néven, és ezen az ágon dolgozz.</p>
</li>
<li>
<p>A <code>neptun.txt</code> fájlba írd bele a Neptun kódodat. A fájlban semmi más ne szerepeljen, csak egyetlen sorban a Neptun kód 6 karaktere.</p>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Android, Java, Kotlin</p>
<p>Az Android hagyományosan Java nyelven volt fejleszthető, azonban az utóbbi években a Google átállt a <a href="https://kotlinlang.org/">Kotlin</a> nyelvre. Ez egy sokkal modernebb nyelv, mint a Java, sok olyan nyelvi elemet ad, amit kényelmes használni, valamint új nyelvi szabályokat, amikkel például elkerülhetőek a Java nyelven gyakori <code>NullPointerException</code> jellegű hibák.</p>
<p>Másrészről viszont a nyelv sok mindenben tér el a hagyományosan C jellegű szintaktikát követő nyelvektől, amit majd látni is fogunk. A labor előtt érdemes megismerkedni a nyelvvel, egyrészt a fent látható linken, másrészt <a href="https://developer.android.com/kotlin/learn">ezt</a> az összefoglaló cikket átolvasva.</p>
</div>
<h2 id="projekt-letrehozasa">Projekt létrehozása<a class="headerlink" href="#projekt-letrehozasa" title="Permanent link">&para;</a></h2>
<p>Hozzunk létre egy Snake nevű projektet az Android Studioban:</p>
<ol>
<li>Hozzunk létre egy új projektet, válasszuk az <em>Empty Activity</em> lehetőséget.</li>
<li>A projekt neve legyen <code>Snake</code>, a kezdőpackage <code>hu.bme.aut.android.snake</code>, a mentési hely pedig a kicheckoutolt repository-n belül a Snake mappa.</li>
<li>Nyelvnek válasszuk a <em>Kotlint</em>-t.</li>
<li>A minimum API szint legyen API24: Android 7.0.</li>
<li>A <em>Build configuration language</em> Kotlin DSL legyen.</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">FILE PATH</p>
<p>A projekt a repository-ban lévő Snake könyvtárba kerüljön, és beadásnál legyen is felpusholva! A kód nélkül nem tudunk maximális pontot adni a laborra!</p>
</div>
<div class="admonition danger">
<p class="admonition-title">FILE PATH</p>
<p>A repository elérési helye ne tartalmazzon ékezeteket, illetve speciális karaktereket, mert az AndroidStudio ezekre érzékeny, így nem fog a kód lefordulni. Érdemes a C:\ meghajtó gyökerében dolgozni.</p>
</div>
<h3 id="eroforrasok-letoltese">Erőforrások letöltése<a class="headerlink" href="#eroforrasok-letoltese" title="Permanent link">&para;</a></h3>
<p>Töltsük le az egyedi <a href="downloads/pixelfont.TTF">fontFamily</a>-t, valamint a szükséges <a href="downloads/res.zip">képeket</a>, majd helyezzük el őket a res mappában a következő szerint.</p>
<ol>
<li>A letöltött .TTF filet tegyük a res/font mappába. Ehhez hozzunk létre egy új packaget a res mappán belül font néven.</li>
<li>A letöltött .ZIP file tartalmát pedig helyezzük el az ennek megfelelő mipmap-... mappákba.</li>
</ol>
<p>Miután ezekkel megvagyunk vegyük fel a következő függőségeket a <code>libs.versions.toml</code> illetve a <code>build.gradle.kts</code> fileba.</p>
<p><code>libs.versions.toml</code></p>
<div class="highlight"><pre><span></span><code><span class="k">[versions]</span>
<span class="n">navigationComposeVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.7.7&quot;</span>
<span class="n">roomRuntime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.6.1&quot;</span>
<span class="n">datastorePreferences</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.1.1&quot;</span>
<span class="n">lifecycleRuntimeComposeAndroid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.8.3&quot;</span>
<span class="n">lifecycleRuntimeKtxVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.4.0&quot;</span>
<span class="n">androidxLifecycleRuntimeKtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.8.4&quot;</span>
<span class="n">lifecycleLivedataKtx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.8.4&quot;</span>
<span class="n">runtimeLivedata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.6.8&quot;</span>
<span class="n">hiltNavigationCompose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.2.0&quot;</span>
<span class="n">hiltAndroid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;2.51.1&quot;</span>
<span class="c1"># Other versions</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">[libraries]</span>
<span class="n">navigation-compose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.navigation:navigation-compose&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;navigationComposeVersion&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-room-ktx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.room:room-ktx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;roomRuntime&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-room-runtime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.room:room-runtime&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;roomRuntime&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-datastore-preferences</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.datastore:datastore-preferences&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;datastorePreferences&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-runtime-compose-android</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycle-runtime-compose-android&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycleRuntimeComposeAndroid&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-runtime-ktx-v240</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle:lifecycle-runtime-ktx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycleRuntimeKtxVersion&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-viewmodel-compose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle:lifecycle-viewmodel-compose&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycleRuntimeKtx&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-runtime-ktx-v284</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle:lifecycle-runtime-ktx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidxLifecycleRuntimeKtx&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-livedata-ktx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle:lifecycle-livedata-ktx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycleLivedataKtx&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-lifecycle-viewmodel-ktx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.lifecycle:lifecycle-viewmodel-ktx&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lifecycleRuntimeKtx&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-runtime-livedata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.compose.runtime&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;runtime-livedata&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;runtimeLivedata&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-hilt-navigation-compose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.hilt:hilt-navigation-compose&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hiltNavigationCompose&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">hilt-android</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.google.dagger:hilt-android&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hiltAndroid&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">hilt-compiler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.google.dagger:hilt-compiler&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;hiltAndroid&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">androidx-room-compiler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">module</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;androidx.room:room-compiler&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">.</span><span class="n">ref</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;roomRuntime&quot;</span><span class="w"> </span><span class="p">}</span>


<span class="c1"># Other libs</span>
</code></pre></div>
<p><code>build.gradles.kts</code>
<div class="highlight"><pre><span></span><code>dependencies {
    // Hilt for DI
    implementation(libs.hilt.android)
    kapt(libs.hilt.compiler)
    implementation(libs.androidx.hilt.navigation.compose)

    // LiveData and ViewModel
    implementation(libs.androidx.runtime.livedata)
    implementation (libs.androidx.lifecycle.viewmodel.ktx)
    implementation(libs.androidx.lifecycle.livedata.ktx)
    implementation( libs.androidx.lifecycle.runtime.ktx.v284)
    implementation(libs.androidx.lifecycle.viewmodel.compose)
    implementation(libs.androidx.lifecycle.runtime.ktx.v240)
    implementation(libs.androidx.lifecycle.runtime.compose.android)

    // DataStore for preferences
    implementation (libs.androidx.datastore.preferences)

    //Room for database
    implementation(libs.androidx.room.runtime)
    implementation(libs.androidx.room.ktx)
    kapt(libs.androidx.room.compiler)

    //Navigation, lifecycle
    implementation(libs.navigation.compose)

    // ... Other dependencies
}
</code></pre></div>
<code>build.gradle.kts</code>
<div class="highlight"><pre><span></span><code><span class="n">plugins</span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;com.google.dagger.hilt.android&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">kotlin</span><span class="p">(</span><span class="s">&quot;kapt&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;1.9.0&quot;</span>
<span class="p">}</span>
<span class="n">android</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">compileSdk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">34</span>
<span class="w">    </span><span class="n">defaultConfig</span><span class="p">{</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">        </span><span class="n">minSdk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24</span>
<span class="w">        </span><span class="n">targetSdk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">34</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">composeOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">kotlinCompilerExtensionVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1.5.1&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Majd a Top-Level <code>build.gradle.kts</code> filet nyissuk meg és adjuk hozzá a HILT-et illetve a KAPT-ot.</p>
<p><code>build.gradle.kts (Snake)</code>
<div class="highlight"><pre><span></span><code>plugins {
    //...
    kotlin(&quot;kapt&quot;) version &quot;1.9.0&quot; apply false
    id(&quot;com.google.dagger.hilt.android&quot;) version &quot;2.51.1&quot; apply false
}
</code></pre></div></p>
<p>Hogy ha mindennel megvagyunk Sync-eljük le a projektet és várjuk meg míg legölt az összes szükséges könyvtár.</p>
<h2 id="navigacio-a-kepernyok-kozott-25-pont">Navigáció a képernyők között (2.5 pont)<a class="headerlink" href="#navigacio-a-kepernyok-kozott-25-pont" title="Permanent link">&para;</a></h2>
<p>Elsőként hozzuk létre a szükséges képernyőket. Még csak demoként lesznek meg, egy teszt szöveggel, majd a további feladatok során kiegészítjük a tényleges képernyővel. Ahhoz hogy a képernyők között navigálni tudjuk szükségünk van a NavHost-ra amiben definiáljuk az egyes kijelzőkre mutató utat. Ehhez hozzunk létre egy új Packaget <code>model</code> néven majd ebben egy <code>navigation</code> néven egy újabb packaget. Ezen belül fogunk első sorban dolgozni. Itt hozzunk létre egy <code>NavGraph</code> nevü Kotlin Filet. </p>
<p>Az alkalmazásban 6 képernyőnk lesz, ezek:</p>
<ul>
<li>Főképernyő (MainScreen)</li>
<li>Eredmények képernyő (HighScoresScreen)</li>
<li>Beállítások képernyő (SettingsScreen)</li>
<li>Játék beállítás képernyő (StartGameScreen)</li>
<li>Játék képernyő (GameScreen)</li>
<li>MainNavScreen (TopBar-os screen)</li>
</ul>
<p>Az utolsó Screen igény szerint változtatható, itt most csak a TopBar miatt fogjuk ezt használni. A képernyők felépítése ezen belül fog változni. A MainNavScreen-en belül lesz egy Scaffold aminek a segítségével beállítunk egy TopAppBar-t. A Content-je pedig egy NavHost-t Graphot fog tartalmazni, aminek a segítségével fogunk váltani az oldalak között.</p>
<p>A TopBar megvalósítását az alábbiak alapján szeretnénk megvalósítani:</p>
<ul>
<li>A Főképernyőn legyen kiírva hogy "Snake" és semmi más.</li>
<li>Beállítás képernyőn legyen egy kis ikon amivel vissza lehet lépni a főképernyőre, valamint legyen title-nek beállítva hogy "Settings"</li>
<li>HighScores képernyőn hasonlóan a beállítás képernyőhöz, legyen egy ikon amivel vissza lehet lépni a főképernyőre, legyen a title "HighScores", illetve egy kuka ikon amivel lehet majd később törölni az adatbázist.</li>
<li>StartGameScreen-en hasonlóan legyen egy vissza gomb, illetve title-nek "Game Settings" legyen beállítva.</li>
<li>A GameScreen-en a felirat legyen egy üres string, ilyenkor a TopAppBar kikapcsolt állapotba fog kerülni.</li>
</ul>
<p>Első sorban hozzunk létre egy új Package-t <code>main</code> néven a <code>model</code> packageba, majd ebben egy <code>MainViewModel</code> nevű Kotlin Filet. Erre azért lesz szükség, hogy a TopBar feliratát, dinamikussan tudjuk majd kezelni, illetve az ikon működését is. Ebben a fájlban helyezzük el az alábbi kódot:</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">MainViewModel</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableLiveData</span><span class="p">(</span><span class="s">&quot;Main Menu&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">title</span><span class="p">:</span><span class="w"> </span><span class="n">LiveData</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_title</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_navigate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableLiveData</span><span class="o">&lt;</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">navigate</span><span class="p">:</span><span class="w"> </span><span class="n">LiveData</span><span class="o">&lt;</span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_navigate</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_showBackArrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableLiveData</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">showBackArrow</span><span class="p">:</span><span class="w"> </span><span class="n">LiveData</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_showBackArrow</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">updateTitle</span><span class="p">(</span><span class="n">newTitle</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">showBackArrow</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_title</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newTitle</span>
<span class="w">        </span><span class="n">_showBackArrow</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">showBackArrow</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setNavigationLambda</span><span class="p">(</span><span class="n">lambda</span><span class="p">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_navigate</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Három változónk lesz, ezek közül az egyik egy Lambda. Ez a navigálásért fog felelni később, illetve van kettő függvényünk aminek a segítségével beállítjuk a privát változók értékét.</p>
<p>Ezután hozzunk létre <code>screen</code> néven egy új Packaget a gyökérmappában (<code>hu.bme.aut...</code>), majd ebben több új Kotlin Filet az alábbi nevekkel: <code>GameScreen</code>, <code>HighScoresScreen</code>, <code>MainNavScreen</code>, <code>MainScreen</code>, <code>SettingsScreen</code>, <code>StartGameScreen</code>. Ezek lesznek az alkalmazás képernyői, kezdetben még csak Demo-ra lesz állítva, és a későbbiekben fogjuk megvalósítani a tényleges kinézetüket.</p>
<p>Folytatásként kezdjük el a <code>MainNavScreen</code> megírását, ugyanis ez fog felelni azért, hogy a <code>NavHost</code> <em>Graphot</em> tartalmazza.</p>
<p>Ennek egy Scaffoldból kell állnia ami dinamikusan fogja kezelni a TopBar-t a képernyőtől függően. Ehhez korábban már létrehoztuk a viewModellünket, ennek a segítségével fogjuk megvalósítani ezt a működést.</p>
<p>Mielőtt elkezdenénk a Scaffold-ot, valósítsuk meg a NavGraph-ot a <code>NavGraph.kt</code> file-ban.</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">(),</span>
<span class="w">    </span><span class="n">startDestination</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mainscreen&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">NavHost</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="n">startDestination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">startDestination</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">    </span><span class="p">){</span>
<span class="w">        </span><span class="c1">//gameScreen</span>

<span class="w">        </span><span class="c1">//preGameScreen</span>

<span class="w">        </span><span class="c1">//mainscreen</span>

<span class="w">        </span><span class="c1">//highscores</span>

<span class="w">        </span><span class="c1">//settings</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Mivel 5 képernyőnk lesz még ezen kívül, ezért 5 különböző navigáció is fog kelleni, amit majd később megvalósítunk, miután mindegyikhez kész van a demo screen. A NavGraph paraméternek megkapja a navControllert, aminek a segítségével fogunk navigálni az ablakok között. Továbbá egy startDestinationt, ami azt fogja megmondani, hogy melyik az a képernyő amit elsőnek meg kell jeleníteni, valamint a mainViewModel-t. Ennek a segítségével fogjuk változtatni dinamikusan a TopBar megjelenését. A későbbiekben a paraméterlista bővülni fog. :)</p>
<p>A TopAppBar működéséről az <a href="https://developer.android.com/develop/ui/compose/components/app-bars">alábbi</a> oldalon jobban meg lehet ismerkedni. Nekünk jelen esetben a <code>navigationIcon</code>, <code>actions</code>, <code>title</code>, <code>color</code> attribútumokra lesz szükségünk. Kezdjük is el a Scaffold felépítését. Ehhez navigáljunk a <code>MainNavScreen</code> fájlba.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">MainNavScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span>
<span class="p">){</span>

<span class="w">    </span><span class="c1">//TopBar</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">title</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">(</span><span class="s">&quot;Snake&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">navigationLambda</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">navigate</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">showBackArrow</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">showBackArrow</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="n">topBar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">){</span>
<span class="w">                </span><span class="n">TopAppBar</span><span class="p">(</span>
<span class="w">                    </span><span class="c1">//NavigationIcon</span>
<span class="w">                    </span><span class="n">navigationIcon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// TODO</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="c1">//Actions</span>
<span class="w">                    </span><span class="n">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// TODO</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="c1">//Title</span>
<span class="w">                    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="c1">// TODO</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="c1">//Colors</span>
<span class="w">                    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TopAppBarDefaults</span><span class="p">.</span><span class="na">topAppBarColors</span><span class="p">(</span><span class="n">containerColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DarkGray</span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">innerPadding</span><span class="w"> </span><span class="o">-&gt;</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">()</span>

<span class="w">        </span><span class="n">NavGraph</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">innerPadding</span><span class="p">),</span>
<span class="w">            </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Az alábbi kód a MainNavScreen skeletonját mutatja. Ezt a következőekben felépítjük a szükséges elemekkel. Jól látható a TopAppBar, valamint azok az elemek amiket fogunk használni. Egy <em>if</em> elágazással szűrjük a TopAppBar megjelenését, amit korábban kikötöttünk, hogy üres <em>String</em> esetén nem jelenítjük meg. (Ez akkor következik be hogy ha már a játék folyamatban van.)</p>
<p><code>NavigationIcon</code>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">showBackArrow</span><span class="p">)</span>
<span class="n">IconButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">navigationLambda</span><span class="o">?.</span><span class="na">invoke</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">        </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span>
<span class="w">        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Back&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
A vissza nyíl megjelenése egy boolean változótól függ, ugyanis a főképernyőn erre nincs szükség. Ilyenkor ezt a Boolean változó False értékbe való billentésével megakadályozzuk, hogy látható legyen. Az <code>onClick</code> esemény megkapja a viewModel értékét, amit az <code>?.invoke()</code> függvénnyel tudunk elsütni.</p>
<p><code>Actions</code>
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">title</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;High Scores&quot;</span><span class="p">){</span>
<span class="w">    </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//TODO</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">            </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">Delete</span><span class="p">,</span>
<span class="w">            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Delete&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">White</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Hogy ha a HighScores képernyőn vagyunk szeretnénk egy extra ikont, aminek a segítségével üríthetjük az adatbázist, amit később létre fogunk hozni. Ehhez szintén egy <em>if</em> elágazást használunk.</p>
<p><code>Title</code></p>
<p><div class="highlight"><pre><span></span><code><span class="n">Text</span><span class="p">(</span>
<span class="w">    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">,</span>
<span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">White</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="p">)</span>
</code></pre></div>
Az AppBar felirata a title változó értékének a segítségével jeleníthető meg. Ez csak egy szimpla <code>Text Composable</code> függvényt igényel.</p>
<p>Ezzel el is készült a <code>MainNavScreen</code> demója.</p>
<div class="admonition info">
<p class="admonition-title">Icon</p>
<p>Előfordulhat, hogy a megadott Icon nem lesz elérhető egyesek számára. Ez a projekt verziójától függ. Ilyenkor csak cseréljük le az Icon-t egy másikra.</p>
</div>
<p>A továbbiakban folytassuk az egyes képernyők felépítésével, illetve a NavGraph kiegészítésével.</p>
<h3 id="main-screen">Main Screen<a class="headerlink" href="#main-screen" title="Permanent link">&para;</a></h3>
<p>A következő lépsben a Main Screent fogjuk megvalósítani.</p>
<p>Ehhez egészítsük ki a MainScreen képernyőt az alábbival:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">MainScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavController</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">//Title</span>

<span class="w">        </span><span class="c1">//Button 1 preGameScreen</span>

<span class="w">        </span><span class="c1">//Button 2 highScores </span>

<span class="w">        </span><span class="c1">//Button 3 settings</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A megfelelő Commentek alá, végezzük el a kiegészítést az alábbiak szerint:</p>
<p><code>Title</code></p>
<div class="highlight"><pre><span></span><code><span class="n">Text</span><span class="p">(</span>
<span class="w">    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Snake Game&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">White</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Ez a Title felirat csak egy <code>Text</code> Composable függvényt fog magába foglalni, amin megjelenítjük a játék címét, vagy bármilyen feliratot. Mi most a <em>Snake Game</em> feliratot fogjuk megjeleníteni ezzel. Látható, hogy adunk egy fontFamily értéket is neki, így fogjuk elérni az egyedi betűtípusunkat.</p>
<p><code>Button 1</code></p>
<div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;preGameScreen&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">        </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Start Game&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Az első gomb fog felelni a játék indításáért, azonban ez a gomb még nem fogja elindítani a játékot, hanem egy új képernyőre fog navigálni, ahol ki lehet választani a játék nehézségét, valamint megadni a játékos nevét. Itt az <code>onClick</code> eseménynek átadjuk a <code>navController.navigate(..)</code> függvényt, amelynek a paraméterébe beírjuk az adott képernyőt ahova navigálni szeretnénk.</p>
<p><code>Button 2</code></p>
<div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;highscores&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">        </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;High Scores&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>A második gombunk ugyanolyan elven működik mint az első, és mint a harmadik fog, itt meg kell változtatnunk a <code>.navigate(..)</code> paraméterét, hogy a HighScores képernyőre navigáljon minket.</p>
<p><code>Button 3</code></p>
<div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;settings&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ButtonDefaults</span><span class="p">.</span><span class="na">buttonColors</span><span class="p">(</span>
<span class="w">        </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Settings&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>A harmadik gomb sem különb az első kettőtől, azt leszámítva, hogy ez a beállítás képernyőre fog navigálni minket.</p>
<p>Majd végül regisztráljuk az útvonalat a NavGraph-ban is</p>
<div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;Snake&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">MainScreen</span><span class="p">(</span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ezzel el is készült a főképernyő, azonban, ha az alkalmazást most elindítjuk még nem teljesen fog működni, ugyanis a többi képernyőre mutató navigáció még nincs kész, illetve a MainActivity-ben nincs meghívva a megfelelő Composable.</p>
<h3 id="settings-screen">Settings Screen<a class="headerlink" href="#settings-screen" title="Permanent link">&para;</a></h3>
<p>Az előzőhöz hasonlóan valósítsuk meg a módosításokat a Settings Screen illetve a NavGraph-ban.</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SettingsScreen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Settings Screen&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Ez csak egy szimpla Column elrendezést fog használni kezdetben. Ezt a Demó képernyőt később le fogjuk cserélni, egyelőre csak a működését fogjuk vizsgálni a NavGraph-nak.</p>
<p>Ehhez illesszük be a megfelelő helyre az alábbi kódot a NavGraph-ban</p>
<p><div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span><span class="s">&quot;settings&quot;</span><span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;Settings&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">setNavigationLambda</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">SettingsScreen</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
Itt a navigáción belül beállítjuk viewModel értékeket ami a TopBar-ért felel, valamint meghívjuk az imént megírt képernyő Composable függvényét.</p>
<h3 id="high-scores-screen">High Scores Screen<a class="headerlink" href="#high-scores-screen" title="Permanent link">&para;</a></h3>
<p>Az előzőhöz hasonlóan hajtsuk végre ugyanazt a működést a High Scores Screen-re is.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">HighScoresScreen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;High Scores Screen&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span><span class="s">&quot;highscores&quot;</span><span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;High Scores&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">setNavigationLambda</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">HighScoresScreen</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Hasonlóan az előzőhöz, itt is módosítjuk a mainViewModel paramétereit úgy, hogy <em>High Scores</em> felirat legyen a TopAppBar-on, illetve a vissza nyíl a főképernyőre mutasson.</p>
<h3 id="game-settings-screen">Game Settings Screen<a class="headerlink" href="#game-settings-screen" title="Permanent link">&para;</a></h3>
<p>Ehhez egyelőre csak beégetett adatot fogunk használni a játékosnév, illetve a nehézséghez, de ez később módosítva lesz.
Nyissuk meg a <code>StartGameScreen</code> file-t, majd módosítsuk a tartalmát az alábbiak szerint.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">StartGameScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Start Game Screen&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">Button</span><span class="p">(</span>
<span class="w">            </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;gameScreen/medium/Player1&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Start Game&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A navController segítségével átadhatunk navigációs argumentumokat, amit később ki fogunk tudni szedni a <code>NavGraph</code>-on belül. Ezeket a <em>Stringeket</em> tudjuk majd felhasználni a játék további paramétereihez.</p>
<p>Modosítsuk a <code>NavGraph</code>-ot úgy, hogy megadjuk az elérési utat az imént létrehozott képernyőhöz.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span><span class="s">&quot;preGameScreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;Game Settings&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">setNavigationLambda</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">StartGameScreen</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Az előzőekhez hasonlóan itt is beállítjuk a mainViewModel-ben a TopBar paramétereit, valamint meghívjuk az elkészített képernyőt.</p>
<p>Már csak egyetlen képernyő van hátra, ez maga a játék képernyője lesz. Kezdetben ez is csak egy Demo képernyő lesz ami meg fogja jeleníteni a beégetett Játékos nevét, illetve a játék nehézségét.</p>
<h3 id="game-screen">Game Screen<a class="headerlink" href="#game-screen" title="Permanent link">&para;</a></h3>
<p><code>GameScreen</code>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">GameScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">difficulty</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Game Screen&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Difficulty: </span><span class="si">$</span><span class="n">difficulty</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Name: </span><span class="si">$</span><span class="n">name</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Jól látható, hogy itt paraméterként kapja meg a szükséges adatokat, de ez később viewModel-re lesz lecserélve, ez csak a kezdeti játék állapotát fogja modellezni.</p>
<p>Már csak egy a <code>NavGraph</code>-ban meg kell adni az elérési utat, illetve a MainActivity-ben meg kell hívni a főképernyő Composable függvényét.</p>
<p><code>NavGraph</code></p>
<p><div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;gameScreen/{playerName}/{difficulty}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">navArgument</span><span class="p">(</span><span class="s">&quot;playerName&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavType</span><span class="p">.</span><span class="na">StringType</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">navArgument</span><span class="p">(</span><span class="s">&quot;difficulty&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavType</span><span class="p">.</span><span class="na">StringType</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="n">GameScreen</span><span class="p">(</span>
<span class="w">        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">arguments</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;playerName&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">difficulty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">arguments</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;difficulty&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Láthatjuk, hogy navigációs argumentumokat az <code>arguments</code> segítségével lehet kiszedni, majd a <code>navArgument</code> segítségével lehet egyesével eltárolni és felhasználni adatként.</p>
<p>Módosítsuk a <code>MainActivity</code>-t úgy, hogy a mainViewModel példányosítva legyen, és adjuk át paraméterként a <code>MainNavScreen</code>nek.</p>
<p><code>MainActivity</code></p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModels</span><span class="p">()</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span><span class="w"> </span><span class="n">Bundle?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>
<span class="w">        </span><span class="n">enableEdgeToEdge</span><span class="p">()</span>
<span class="w">        </span><span class="n">setContent</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SnakeTheme</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">MainNavScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">mainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mainViewModel</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ha mindent jól csináltunk akkor az alkalmazás elindítása után a főképernyő fogad minket ahonnan a gombok segítségével el tudunk navigálni az egyes képernyőkre.</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (2.5 pont)</p>
<p>Készíts <strong>5 képernyő képet</strong> az elkészült képernyőkről, amelyen látszik az <strong>elkészült oldal</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f1a.png, f1b.png, f1c.png, f1d.png, f1e.png néven töltsd föl.</p>
</div>
<h2 id="kepernyok-kiegeszitese-25-pont">Képernyők kiegészítése (2.5 pont)<a class="headerlink" href="#kepernyok-kiegeszitese-25-pont" title="Permanent link">&para;</a></h2>
<p>A második feladat a már meglévő képernyők megtervezése és kiegészítése lesz. A dokumentáció elején látható képernyőket szeretnénk megvalósítani. Ehhez kezdjük először a legegyszerűbb képernyővel. Ez a Settings Screen lesz, itt csak egyetlen kapcsolót fogunk megjeleníteni, amivel majd a későbbiek során foglalkozunk, amikor a Sensor részét is beleépítettük az alkalmazásba. Ehhez nyissuk meg a SettingsScreen fájlt, és módosítsuk az alábbiak szerint.</p>
<h3 id="settings-screen_1">Settings Screen<a class="headerlink" href="#settings-screen_1" title="Permanent link">&para;</a></h3>
<p align="center">
<a class="glightbox" href="./assets/settingsscreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/settingsscreen.png" width="320"></a>
</p>

<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SettingsScreen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Top</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Text</span><span class="p">(</span>
<span class="w">                </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sensor  Controlled&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">White</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">26.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">                </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">            </span><span class="n">Switch</span><span class="p">(</span>
<span class="w">                </span><span class="n">checked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSensorControlled</span><span class="p">,</span>
<span class="w">                </span><span class="n">onCheckedChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">isSensorControlled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Kezdetben a kapcsoló állapotát így fogjuk tárolni, viszont ez később viewModel formájában lesz megvalósítva, hogy majd a játék képernyő is megkapja az állapotot. Egy egyszerű Column van elhelyezve a képernyőn, amiben egyetlen Row van. Ez tartalmaz egy Label feliratot <code>Text</code> Composable függvénnyel, illetve egy kapcsolót a <code>Switch</code> Composable-vel.</p>
<p>Mivel az <code>isSensorControlled</code> egy állapot, ezért minden egyes állapotváltozásnál az a Composable ami függ ettől a változótól újra rajzolódik, ezáltal a kapcsoló ki-be kapcsolható lesz.</p>
<p>Folytatásként egészítsük ki a High Scores Screent.</p>
<h3 id="high-scores-screen_1">High Scores Screen<a class="headerlink" href="#high-scores-screen_1" title="Permanent link">&para;</a></h3>
<p align="center">
<a class="glightbox" href="./assets/highscorescreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/highscorescreen.png" width="320"></a>
</p>

<p>Ezt a képernyőt hasonlóan egy Column-ba ágyazva fogjuk megvalósítani, azonban szeretnénk egy fejlécet a táblázatos összefoglalónak. Ezt egy Row segítségével fogjuk megvalósítani, a Contentjéhez pedig létrehozunk egy saját Composable függvényt, amely táblázatos formában fogja megjeleníteni az adatokat. Ehhez hozzunk létre egy <code>TableText</code> függvényt a HighScoresScreen-en belülre az alábbiak szerint:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">TableText</span><span class="p">(</span><span class="n">text</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Text</span><span class="p">(</span>
<span class="w">            </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">text</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">            </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">White</span><span class="p">,</span>
<span class="w">            </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">8.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A függvény két paramétert fog kapni, az egyik egy String típusút ez fogja az adatot tartalmazni, a másik pedig egy Modifier, aminek a segítségével beállítjuk az oszlop súlyait. Jelen esetben nekünk 2-1-2-es súlyozásra lesz szükségünk. </p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">HighScoresScreen</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">highScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">Triple</span><span class="p">(</span><span class="s">&quot;John&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Easy&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">Triple</span><span class="p">(</span><span class="s">&quot;Jane&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Medium&quot;</span><span class="p">),</span>
<span class="w">        </span><span class="n">Triple</span><span class="p">(</span><span class="s">&quot;Jack&quot;</span><span class="p">,</span><span class="w"> </span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hard&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">            </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">            </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">TableText</span><span class="p">(</span><span class="s">&quot;Name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">            </span><span class="n">TableText</span><span class="p">(</span><span class="s">&quot;Score&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">))</span>
<span class="w">            </span><span class="n">TableText</span><span class="p">(</span><span class="s">&quot;Difficulty&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">LazyColumn</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="n">Modifier</span>
<span class="w">                </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">items</span><span class="p">(</span><span class="n">highScores</span><span class="p">.</span><span class="na">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">                    </span><span class="n">Modifier</span>
<span class="w">                        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span><span class="p">,</span>
<span class="w">                    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="w">                </span><span class="p">){</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">first</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">second</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">))</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">third</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Kezdetben csak beégetett adatokkal fogunk dolgozni, ezt később lecseréljük adatbázisos adatokra. A High Score lista 3 adatból fog állni, név, pontok, és nehézség. Ezt az adatot egy LazyColum segítségével fogjuk megjeleníteni a képernyőn. Ehhez meg kell adni a lista méretét, illetve azt hogy mit jelenítsen meg. Ehhez szintén a TableText Composable függvényt használjuk. A LazyColumn fölött egy Row-t helyeztünk el, amely hasonlóan kapta a Content-et, mint a LazyColumn, a különbség az, hogy ez nem része a LazyColumn-nak, ez egy <em>fejlécként</em> szolgál nekünk, amelynek a pozíciója fix.</p>
<h3 id="game-settings-screen_1">Game Settings Screen<a class="headerlink" href="#game-settings-screen_1" title="Permanent link">&para;</a></h3>
<p align="center">
<a class="glightbox" href="./assets/gamesettingsscreen.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/gamesettingsscreen.png" width="320"></a>
</p>
<p>Harmadik lépésben a Game Settings Screent fogjuk módosítani az alábbiak alapján. </p>
<ul>
<li>Tartalom a képernyő közepén helyezkedjen el</li>
<li>Egy Sliderrel fogjuk állítani a játék nehézségét</li>
<li>Egy TextFieldbe fogjuk írni a játékos nevét</li>
<li>Egy gombbal fogjuk indítani a játékot, amely a következő képernyőre navigál az adatainkkal.</li>
</ul>
<p>Ennek a megvalósításához használjuk az alábbi kódot:
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">StartGameScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavController</span><span class="p">,</span>
<span class="p">){</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">playerName</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">difficulty</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nv">emptyField</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">remember</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">mutableStateOf</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>

<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="m">16.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">(),</span>
<span class="w">        </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">        </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">//GameModeMap</span>


<span class="w">        </span><span class="c1">//Difficulty Label</span>


<span class="w">        </span><span class="c1">//Difficulty Slider</span>


<span class="w">        </span><span class="c1">//Name Field</span>


<span class="w">        </span><span class="c1">//Start Button</span>


<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">GameDifficulty</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">EASY</span><span class="p">,</span>
<span class="w">    </span><span class="n">MEDIUM</span><span class="p">,</span>
<span class="w">    </span><span class="n">HARD</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Ahhoz hogy a játék nehézségét illetve a játékos nevet tudjuk állítani, szükségünk van két változóra, illetve még plusz egy változóra, hogy a felhasználó ne tudjon játékos név megadása nélkül tovább lépni a következő képernyőre. A következő lépéseket követve egészítsük ki a hiányzó UI elemeket.</p>
<h4 id="game-mode-map">Game Mode Map<a class="headerlink" href="#game-mode-map" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">gameModeMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span>
<span class="w">    </span><span class="m">0.0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Triple</span><span class="p">(</span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span><span class="p">,</span><span class="w"> </span><span class="m">0.0</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Green</span><span class="p">),</span>
<span class="w">    </span><span class="m">0.5</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Triple</span><span class="p">(</span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">MEDIUM</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Yellow</span><span class="p">),</span>
<span class="w">    </span><span class="m">1.0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Triple</span><span class="p">(</span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">HARD</span><span class="p">,</span><span class="w"> </span><span class="m">1.0</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Red</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Ennek a map-nek a segítségével fogjuk nyilván tartani az egyes értékekhez tartozó adatokat. 3 állapot lesz a Slider-en:</p>
<ol>
<li>Bal oldalon</li>
<li>Középen</li>
<li>Jobb oldalon</li>
</ol>
<p>Ezekhez mindegyikhez hozzá van rendelve egy Triple map, ami tartalmazza a játék nehézségét egy Enum Class segítségével, magát a Slider értékét, illetve egy színt, amivel könnyen tudjuk demonstrálni a játék nehézségét a Label feliraton.</p>
<h4 id="difficulty-label">Difficulty Label<a class="headerlink" href="#difficulty-label" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">Text</span><span class="p">(</span>
<span class="w">    </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">difficulty</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span>
<span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gameModeMap</span><span class="p">.</span><span class="na">values</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">difficulty</span><span class="w"> </span><span class="p">}.</span><span class="na">third</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">    </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="p">)</span>
</code></pre></div>
<p>Ez fog felelni a nehézség feliratáért. Itt értékként átadjuk az egyik változónk értékét, majd színnek az előbb létrehozott map értékét. Itt egy predikátum segítségével kiszűrjük az aktuális játék nehézséget, majd átadjuk a harmadik értékét a color attribútumnak.</p>
<h4 id="difficulty-slider">Difficulty Slider<a class="headerlink" href="#difficulty-slider" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">Slider</span><span class="p">(</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gameModeMap</span><span class="p">.</span><span class="na">values</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">difficulty</span><span class="w"> </span><span class="p">}.</span><span class="na">second</span><span class="p">.</span><span class="na">toFloat</span><span class="p">(),</span>
<span class="w">    </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">difficulty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gameModeMap</span><span class="o">[</span><span class="nb">it</span><span class="p">.</span><span class="na">toDouble</span><span class="p">()</span><span class="o">]!!</span><span class="p">.</span><span class="na">first</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">colors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SliderDefaults</span><span class="p">.</span><span class="na">colors</span><span class="p">(</span>
<span class="w">        </span><span class="n">thumbColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">activeTrackColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">inactiveTrackColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span>
<span class="w">    </span><span class="n">valueRange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0f</span><span class="p">..</span><span class="m">1.0f</span>
<span class="p">)</span>
</code></pre></div>
<p>Az előzőhöz hasonlóan a GameModeMap-et használva átaduk az értéket a Slider-nek, csak itt nekünk a második adatra van szükség. Hogy ha az értéket változtatjuk, akkor magát a difficulty változót kell felülírni az új értékkel. A steps, illetve a valueRange segítségével beállíthatjuk a Slider működését, nekünk most 0.0-1.0 közötti értékekre van szükségünk és azon belül egy lépéses Sliderre.</p>
<h4 id="name-field">Name Field<a class="headerlink" href="#name-field" title="Permanent link">&para;</a></h4>
<p><div class="highlight"><pre><span></span><code><span class="n">OutlinedTextField</span><span class="p">(</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerName</span><span class="p">,</span>
<span class="w">    </span><span class="n">onValueChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">isError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">emptyField</span><span class="p">,</span>
<span class="w">    </span><span class="n">supportingText</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">emptyField</span><span class="p">)</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Please enter a name&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="s">&quot;Player Name&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">    </span><span class="n">textStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextStyle</span><span class="p">(</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
Ez a TextField egy összetettebb Composable lesz, de a leírás alapján könnyne meg lehet érteni.</p>
<ul>
<li><code>value</code> - Ennek a paraméternek átadjuk magát a playerName változó értékét.</li>
<li><code>onValueChange</code> - Ennek az attribútum segítségével adjuk meg egy lambdába, hogy mi történjen, hogy ha a felhasználó írt a TextField-be. Jelen esetben felülírjuk a változónk értékét, és mivel egy remember - mutableStateOf-os változóról van szó, ezért Recomposition valósul meg, így a friss értékét fogjuk látni a változónak.</li>
<li><code>isError</code> - Itt egy Boolean változót tudunk átadni értékként, amire azért van szükség, hogy ha a felhasználó üressen hagyná ezt a mezőt, ne tudjun tovább lépni a következő képernyőre.</li>
<li><code>supportingText</code> - Itt meg tudunk adni egyéb segítséget a felhasználónak, hogy ha üressen hagyná a mező értékét, és tovább szeretne lépni, akkor jelenítse meg a <em>Please enter a name</em> feliratot.</li>
<li><code>label</code> - Ez egy kiegészítés az OutlinedTextField Composable függvényben. Ennek a segítségével tudunk megadni informáló feliratot, hogy az adott TextField miért felel.</li>
<li><code>textStyle</code> - Ennek a segítségével tudunk beállítani új stílust a kiírásra.</li>
</ul>
<h4 id="start-button">Start Button<a class="headerlink" href="#start-button" title="Permanent link">&para;</a></h4>
<p><div class="highlight"><pre><span></span><code><span class="n">Button</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">playerName</span><span class="p">.</span><span class="na">isNotEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;gameScreen/</span><span class="si">${</span><span class="n">playerName</span><span class="si">}</span><span class="s">/</span><span class="si">${</span><span class="n">difficulty</span><span class="p">.</span><span class="na">name</span><span class="si">}</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span>
<span class="w">            </span><span class="n">emptyField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Start Game&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Ez egy szimpla gomb, ami azért felel, hogy elindítsa a játékot, hogy ha a felhasználó mindent helyesen csinált. Az onClick eseménynek egy if-else elágazást adunk át, ami ellenőrzi, hogy a felhasználó írt-e be adatot a TextField-be. Hogy ha üresen hagyta, akkor a Boolean változót bebillenti true értékbe, aminek köszönhetően megjelenik az SupportingText üzenet. Ilyenkor a felhasználó nem tud tovább menni a következő ablakra mindaddig amíg a TextField üres.</p>
<p>Ahhoz hogy a GameScreen-t is meg tudjuk csinálni, ahhoz előtte magát a játék logikát kell megvalósítani. Folytatásként elkészítjük a játéknak az állapotait egy Data Class segítségével, majd a Snake-hez tartozó viewModel-t is.</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (2.5 pont)</p>
<p>Készíts <strong>4 képernyő képet</strong> az elkészült képernyőkről, amelyen látszik az <strong>elkészült oldal</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként, és/vagy játékosnévként megadva</strong>. A képeket a megoldásban a repository-ba f2a.png, f2b.png, f2c.png, f2d.png néven töltsd föl.</p>
</div>
<h2 id="snake-state-snake-view-model-4-pont">Snake State / Snake View Model (4 pont)<a class="headerlink" href="#snake-state-snake-view-model-4-pont" title="Permanent link">&para;</a></h2>
<h3 id="snake-state">Snake State<a class="headerlink" href="#snake-state" title="Permanent link">&para;</a></h3>
<p>Első lépésben elkészítjük a kígyó állapotáért felelős Data Classt. Készítsünk a <code>model</code> packagen belül egy <code>snake</code> packaget, amiben egy <code>SnakeState</code> Kotlin filet hozunk létre, majd a mellékelt kód segítségével megvalósítjuk a logikát.</p>
<div class="highlight"><pre><span></span><code><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SnakeState</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">xSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">ySize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">direction</span><span class="p">:</span><span class="w"> </span><span class="n">Direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">,</span>
<span class="w">    </span><span class="c1">//val prevDirection: Direction = Direction.RIGHT,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">snake</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Coordinate</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span><span class="n">Coordinate</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)),</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">food</span><span class="p">:</span><span class="w"> </span><span class="n">Coordinate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateFood</span><span class="p">(</span><span class="n">xSize</span><span class="p">,</span><span class="w"> </span><span class="n">ySize</span><span class="p">),</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isGameOver</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">gameState</span><span class="p">:</span><span class="w"> </span><span class="n">GameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">IDLE</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//Companion Object - Generate Food</span>


<span class="w">    </span><span class="c1">//Get State</span>


<span class="p">}</span>
<span class="c1">//GameState</span>


<span class="c1">//Direction</span>


<span class="c1">//Coordinate</span>
</code></pre></div>
<p>Egészítsük ki a SnakeState Data Class Skeletonját az alábbiak szerint:</p>
<h4 id="generate-food">Generate Food<a class="headerlink" href="#generate-food" title="Permanent link">&para;</a></h4>
<p>Ez a függvény egy random koordinátát fog generálni a pályán, úgy, hogy az adott koordináta X: 1-20 között, Y:1-30 közöttre essen. Ezt az alábbi függvénnyel tudjuk megvalósítani:</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">generateFood</span><span class="p">(</span>
<span class="w">        </span><span class="n">xSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">        </span><span class="n">ySize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="w">    </span><span class="p">):</span><span class="w"> </span><span class="n">Coordinate</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">(</span>
<span class="w">            </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xSize</span><span class="o">-</span><span class="m">1</span><span class="p">),</span>
<span class="w">            </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Random</span><span class="p">.</span><span class="na">nextInt</span><span class="p">(</span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ySize</span><span class="o">-</span><span class="m">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Azonban ez még hibát fog mutatni a kódszerkesztő felületen, de ennek a hiányzó Data Class az oka. A következő lépésben ezt fogjuk megvalósítani.</p>
<h4 id="coordinate-data-class">Coordinate Data Class<a class="headerlink" href="#coordinate-data-class" title="Permanent link">&para;</a></h4>
<p>Ez a Data Class két attribútumot fog tartalmazni, egy X és egy Y. Ez fog felelni egyetlen koordinátának a helyéért.</p>
<div class="highlight"><pre><span></span><code><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Coordinate</span><span class="p">(</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">y</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="p">)</span>
</code></pre></div>
<p>A megadott kód segítségével egészítsük ki a fájlt.</p>
<h4 id="game-state-direction-enum-class">Game State / Direction Enum Class<a class="headerlink" href="#game-state-direction-enum-class" title="Permanent link">&para;</a></h4>
<p>Ahhoz hogy minden hibát eltűntessünk a kódból létre kell hoznunk a hiányzó Enum Class-okat is. </p>
<ul>
<li>A GameState Enum Class a játék állapotáért felel<ul>
<li>IDLE - Kezdeti állapot</li>
<li>STARTED - Fut</li>
<li>Paused - Leállítva</li>
</ul>
</li>
<li>Direction Enum Class pedig a jelenlegi irányt fogja tárolni.<ul>
<li>UP - A kígyó felfele megy</li>
<li>DOWN - A kígyó lefele megy</li>
<li>LEFT - A kígyó balra megy</li>
<li>RIGHT - A kígyó jobbra megy</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">GameState</span><span class="p">{</span>
<span class="w">    </span><span class="n">IDLE</span><span class="p">,</span><span class="w"> </span><span class="n">STARTED</span><span class="p">,</span><span class="w"> </span><span class="n">PAUSED</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">enum</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">Direction</span><span class="p">{</span>
<span class="w">    </span><span class="n">UP</span><span class="p">,</span><span class="w"> </span><span class="n">DOWN</span><span class="p">,</span><span class="w"> </span><span class="n">LEFT</span><span class="p">,</span><span class="w"> </span><span class="n">RIGHT</span>
<span class="p">}</span>
</code></pre></div>
<p>Ezután már csak egy getter függvényre van szükség aminek a segítségével le tudjuk kérni a jelenlegi játék állapotát.</p>
<h4 id="get-state-fuggveny">Get State függvény<a class="headerlink" href="#get-state-fuggveny" title="Permanent link">&para;</a></h4>
<p><div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">getState</span><span class="p">():</span><span class="w"> </span><span class="n">GameState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">gameState</span>
<span class="p">}</span>
</code></pre></div>
Ez egy egyszerű getter függvény, amely vissza adja a játék jelenlegi állapotát.</p>
<p>Ezen kívűl meg kell valósítanunk egy egyszerű Sealed Class-t ami magáért az Eventekért fog felelni. </p>
<ul>
<li>Start Game</li>
<li>Pause Game</li>
<li>Reset Game</li>
<li>Change Dir</li>
</ul>
<p>Ehhez hozzunk létre egy új Kotlin File-t a <code>snake</code> Packageba <code>SnakeEvent</code> néven, majd egészítsük ki az alábbi kód alapján:</p>
<div class="highlight"><pre><span></span><code><span class="kd">sealed</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">SnakeEvent</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">StartGame</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">PauseGame</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="nc">ResetGame</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">()</span>
<span class="w">    </span><span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">ChangeDir</span><span class="p">(</span><span class="kd">val</span><span class="w"> </span><span class="nv">dir</span><span class="p">:</span><span class="w"> </span><span class="n">Direction</span><span class="p">):</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Végül szükségünk van magára a ViewModel-re, ami a kígyó viselkedéséért fog felelni.</p>
<h3 id="view-model">View Model<a class="headerlink" href="#view-model" title="Permanent link">&para;</a></h3>
<p>Ez a kód jóval hosszabb lesz mint az eddigiek, így a megértése nagy odafigyelést igényel!</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">SnakeViewModel</span><span class="p">():</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">(){</span>
<span class="w">    </span><span class="c1">//State</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">SnakeState</span><span class="p">())</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_state</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="c1">//Game Difficulty</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_gameDifficulty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">gameDifficulty</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="n">GameDifficulty</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_gameDifficulty</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="c1">//Player Name</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">playerName</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="w">    </span><span class="c1">//##FUNS##</span>

<span class="w">    </span><span class="c1">//Event Handling</span>


<span class="w">    </span><span class="c1">//Set Game Difficulty</span>


<span class="w">    </span><span class="c1">//Set Player Name</span>


<span class="w">    </span><span class="c1">//Start Game</span>


<span class="w">    </span><span class="c1">//Resume Game</span>


<span class="w">    </span><span class="c1">//Direction Update</span>


<span class="w">    </span><span class="c1">//Game Update</span>


<span class="w">    </span><span class="c1">//CHECK IF COORDINATE IS IN BOUNDS</span>

<span class="p">}</span>
</code></pre></div>
<p>Az egyes viewModel elemeket lépésről lépésre fogjuk hozzáadni a viewModellhez. Kezdetben a legegyszerűbbekkel fogjuk kezdeni.</p>
<p><strong>Set Game Difficulty</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">setGameDifficulty</span><span class="p">(</span><span class="n">difficulty</span><span class="p">:</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">){</span>
<span class="w">    </span><span class="n">_gameDifficulty</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">difficulty</span>
<span class="p">}</span>
</code></pre></div>
<p>Ez egy egyszerű függvény amelynek a segítségével a paraméterben átadott játéknehézséget fogja beállítani.</p>
<p><strong>Set Player Name</strong></p>
<p>Szintén az előzőhöz hasonlóan működve, ez a játékos nevét fogja beállítani.</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">setPlayerName</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">){</span>
<span class="w">    </span><span class="n">playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>
<span class="p">}</span>
</code></pre></div>
<p><strong>Direction Update</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">updateDir</span><span class="p">(</span><span class="n">dir</span><span class="p">:</span><span class="w"> </span><span class="n">Direction</span><span class="p">){</span>
<span class="w">    </span><span class="n">_state</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dir</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Szintén hasonlóan működik, itt magát a kígyó menetirányát fogjuk állítani.</p>
<p>A következő egy kicsit hosszabb kód lesz, ez magát az Eventeket fogja kezelni, így muszáj mindegyik eventhez megvalósítani a működést.</p>
<p><strong>Event Handling</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">onEvent</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">){</span>
<span class="w">    </span><span class="k">when</span><span class="p">(</span><span class="n">event</span><span class="p">){</span>
<span class="w">        </span><span class="c1">//Pause Game</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">PauseGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//TODO</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//Reset Game</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ResetGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//TODO</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//Start Game</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//TODO</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//Direction Handle</span>
<span class="w">        </span><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//PASS IF GAME NOT STARTED</span>

<span class="w">            </span><span class="c1">//TODO</span>

<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><code>Pause Game</code></p>
<p><div class="highlight"><pre><span></span><code><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">PauseGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_state</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Ha ez az event következik be, akkor a jelenlegi állapotát lemásoljuk a kígyónak, és gameState paraméterként átadjuk neki a PAUSED állapotot.</p>
<p><code>Reset Game</code>
<div class="highlight"><pre><span></span><code><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ResetGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
Ha ez az állapot következik be, akkor egy teljesen új állapotot kap a kígyó, mint ha frissen indítanánk egy új játékot.</p>
<p><code>Start Game</code>
<div class="highlight"><pre><span></span><code><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_state</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">startGame</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
Ennél az állapotnál hasonlóan járunk el, mint a <code>Pause Game</code> állapotnál, csak itt a játék állapotát STARTED-re állítjuk.</p>
<p><code>Direction Handle</code>
<div class="highlight"><pre><span></span><code><span class="k">is</span><span class="w"> </span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//PASS IF GAME NOT STARTED</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">gameState</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">updateDir</span><span class="p">(</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">dir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">dir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">dir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">event</span><span class="p">.</span><span class="na">dir</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">direction</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">direction</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Végül magát az irányváltoztatásért felelős eseményt is megvalósítjuk az alábbiak szerint. Itt fontos, hogy az egyes irányváltoztatások csak akkor lehetségesek, hogy ha a választott irány az adott iránynak nem a 180 fokos elforgatása, ugyanis ilyenkor a kígyó saját magába forogna át, amely a játék végét eredményezné.</p>
<p>Ezután a Update Game függvényt kell megvalósítanunk, amelynek a segítségével a játék állapotát frissítjük, minden egyes mozgás után. Ez szintén egy hosszabb kód lesz, de igyekeztünk a lehető legjobban szétszedni.</p>
<p><strong>Update Game</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">updateGame</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//GAME OVER CHECK</span>


<span class="w">    </span><span class="c1">//HEAD, GRID SIZE</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">head</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">snake</span><span class="p">.</span><span class="na">first</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">xGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">xSize</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">yGrid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">ySize</span>

<span class="w">    </span><span class="c1">//NEW HEAD COORDINATE</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">newHead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">direction</span><span class="p">){</span>

<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//GAME OVER - SNAKE HIT ITSELF OR WALL</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">snake</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">newHead</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">        </span><span class="o">!</span><span class="n">isInBounds</span><span class="p">(</span>
<span class="w">            </span><span class="n">newHead</span><span class="p">,</span>
<span class="w">            </span><span class="n">xGrid</span><span class="p">,</span>
<span class="w">            </span><span class="n">yGrid</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">){</span>
<span class="w">        </span><span class="c1">//DATABASE INSERT</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">isGameOver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//NEW SNAKE AND FOOD</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">snake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newSnake</span><span class="p">,</span><span class="w"> </span><span class="n">food</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newFood</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p><code>GameOver Check</code></p>
<p>Ez egy szimpla if elágazás ahol leellenőrizzük, hogy a játék Game Over állapotban van-e, vagy sem.
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">isGameOver</span><span class="p">){</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">state</span>
<span class="p">}</span>
</code></pre></div>
<code>New Head Coordinates</code></p>
<p>Ez egy kicsit összetettebb értékadás, ugyanis itt figyelembe kell venni a jelenlegi irányt is, és az alapján kell kiszámítani az új koordinátát.</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">newHead</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">direction</span><span class="p">){</span>
<span class="w">    </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">head</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">head</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>
<span class="w">    </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">head</span><span class="p">.</span><span class="na">y</span><span class="p">))</span>
<span class="w">    </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">head</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">head</span><span class="p">.</span><span class="na">y</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
<code>New Snake and Food</code></p>
<p><div class="highlight"><pre><span></span><code><span class="kd">var</span><span class="w"> </span><span class="nv">newSnake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mutableListOf</span><span class="p">(</span><span class="n">newHead</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">snake</span>
<span class="kd">val</span><span class="w"> </span><span class="nv">newFood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newHead</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">food</span><span class="p">){</span>
<span class="w">    </span><span class="n">SnakeState</span><span class="p">.</span><span class="na">generateFood</span><span class="p">(</span><span class="n">xGrid</span><span class="p">,</span><span class="w"> </span><span class="n">yGrid</span><span class="p">)</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">state</span><span class="p">.</span><span class="na">food</span>
<span class="p">}</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newHead</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">food</span><span class="p">){</span>
<span class="w">    </span><span class="n">newSnake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newSnake</span><span class="p">.</span><span class="na">toMutableList</span><span class="p">()</span>
<span class="w">    </span><span class="n">newSnake</span><span class="p">.</span><span class="na">removeLast</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
Itt létrehozunk egy új kígyót, amelynek az első eleme az új fej koordinátája lesz (newHead), majd ehhez hozzáfűzzük a már meglévő kígyónkat. Valamint új almát is kell generálnunk. Ehhez ellenőriznünk kell, hogy a kígyó megette-e az almát vagy sem. Ha megette akkor új almát generálunk, hogy ha nem ette meg, akkor a jelenlegi alma koordinátáját adjuk át az újnak.</p>
<div class="admonition info">
<p class="admonition-title">Megette, vagy sem?</p>
<p>Hogy megette-e az almát a kígyó vagy sem, azt onnan tudjuk, hogy a kígyó fejének a koordinátája megegyezik az alma koordinátáival! :)</p>
</div>
<p>Végül szükségünk van egy függvényre amit ugyan már felhasználtunk, de nem valósítottuk még meg. Ez az isInBound függvény lesz, ez azt ellenőrzi le, hogy a kígyó neki ment-e a falnak vagy sem. 
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">isInBounds</span><span class="p">(</span><span class="n">coordinate</span><span class="p">:</span><span class="w"> </span><span class="n">Coordinate</span><span class="p">,</span><span class="w"> </span><span class="n">xGridSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">yGridSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">xGridSize</span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">yGridSize</span><span class="o">-</span><span class="m">1</span>
<span class="p">}</span>
</code></pre></div>
Végül már csak két függvényünk van hátra a viewModellből amit az alábbi kód alapján meg fogunk tudni írni.</p>
<p><strong>Start Game</strong></p>
<p>Ez a függvény magáért a kígyó léptetéséért felel, illetve ez a függvény hívja meg az imént létrehozott <em>updateGame</em> függvényt megadott időközönként. (Ez a játék nehézségétől fog függeni.)</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">startGame</span><span class="p">(){</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">isGameOver</span><span class="p">){</span>
<span class="w">        </span><span class="n">_state</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">gameDifficulty</span><span class="p">.</span><span class="na">collect</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">difficulty</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">val</span><span class="w"> </span><span class="nv">delayMillis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">difficulty</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">320L</span>
<span class="w">                        </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">MEDIUM</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">220L</span>
<span class="w">                        </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">HARD</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="m">120L</span>
<span class="w">                    </span><span class="p">}</span>
<span class="w">                    </span><span class="n">_state</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">updateGame</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">)</span>
<span class="w">                    </span><span class="n">delay</span><span class="p">(</span><span class="n">delayMillis</span><span class="p">)</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
A függvény elején leellenőrizzük, hogy a játék még megy-e (az az nincs game over), majd ez alapján frissítjük az állapotot STARTED állapotba.</p>
<p>Ezután egy viewModelScope segítségével tudunk delay-t alkalmazni, ami a kígyó mozgásának késleltetéséért felel. A késleltetés a játék nehézségétől fog függeni.</p>
<p>Végül a resume game függvényt is meg tudjuk valósítani, amely elindítja a játékot a mentett pozícióból.</p>
<p><strong>Resume Game</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">resumeGame</span><span class="p">(){</span>
<span class="w">    </span><span class="n">_state</span><span class="p">.</span><span class="na">update</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">gameState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">startGame</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>
<p>Így még sajnos önmagában a projekt nem működik, ugyanis a Game Screen még nincs kész. A következő feladatban ezt is meg fogjuk valósítani, illetve a szükséges DrawScope függvényeket is létre fogjuk hozni.</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (4 pont)</p>
<p>Készíts <strong>2 képernyőképet</strong> az elkészült kódról, amelyen látszik a <strong>SnakeState kódja, valamint a ViewModel-ben az Event kódja</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f3a.png, f3b.png néven töltsd föl.</p>
</div>
<h2 id="game-screen-drawscope-fuggvenyek-4-pont">Game Screen / DrawScope függvények (4 pont)<a class="headerlink" href="#game-screen-drawscope-fuggvenyek-4-pont" title="Permanent link">&para;</a></h2>
<p>Ahhoz hogy a Game Screen-t el tudjuk készíteni először szükségünk van 3 DrawScope-ra. <em>DrawBoard</em>, <em>DrawFood</em>, <em>DrawSnake</em>. Ezek egy-egy DrawScope függvények, amellyeket meg tudunk hívni a Canvas Composable belsejében. Magát a pályát a játékot a Canvas Composable-val fogjuk megvalósítani.</p>
<p>A 3 DrawScopen kívül szükségünk van még egy pár segédfüggvényre, ezek a (BodyImage, IsTurn, TurnImage) függvények csak a játék szépítéséért felelnek, hogy ha a kígyónak nem csak egy kör alakú testet szeretnénk adni, hanem valami képet, vagy Icon-t, amin látszódik a kígyó fordulása is.</p>
<p align="center">
<a class="glightbox" href="./assets/example.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/example.png" width="500"></a>
</p>

<p>Itt az alábbi példa megmutat egy olyan opciót amit meg kellene akadályoznunk ezekkel a függvényekkel.</p>
<p>Első sorban valósítsuk meg a DrawScope függvényeket. Ehhez hozzunk létre 1 új Packaget a gyökér mappában <code>draw</code> néven, majd ezekben 3 újabb Packaget -- <strong>board</strong>, <strong>food</strong>, <strong>snake</strong> néven.</p>
<p><strong>DrawBoard</strong></p>
<p>Elsőnek valósítsuk meg a DrawBoard függvényünket. Ehhez hozzunk létre egy új Kotlin File-t a board packageben DrawBoard néven, majd írjuk bele az alábbi kódot.</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="n">DrawScope</span><span class="p">.</span><span class="nf">drawBoard</span><span class="p">(</span>
<span class="w">    </span><span class="n">cellSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Float</span><span class="p">,</span>
<span class="w">    </span><span class="n">cellColor</span><span class="p">:</span><span class="w"> </span><span class="n">Color</span><span class="p">,</span>
<span class="w">    </span><span class="n">borderCellColor</span><span class="p">:</span><span class="w"> </span><span class="n">Color</span><span class="p">,</span>
<span class="w">    </span><span class="n">gridWidth</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="n">gridHeight</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="p">){</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">gridWidth</span><span class="p">){</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">gridHeight</span><span class="p">){</span>
<span class="w">            </span><span class="kd">val</span><span class="w"> </span><span class="nv">isBorderCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">gridWidth</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">gridHeight</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span>
<span class="w">            </span><span class="n">drawRect</span><span class="p">(</span>
<span class="w">                </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isBorderCell</span><span class="p">)</span><span class="w"> </span><span class="n">borderCellColor</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="n">cellColor</span><span class="p">,</span>
<span class="w">                </span><span class="n">topLeft</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cellSize</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cellSize</span><span class="p">),</span>
<span class="w">                </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Size</span><span class="p">(</span><span class="n">cellSize</span><span class="p">,</span><span class="w"> </span><span class="n">cellSize</span><span class="p">)</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A függvény lényege, hogy paraméterként átadjuk a következőeket:</p>
<ul>
<li>cellSize - Egyetlen cellának a mérete a Board-on.</li>
<li>cellColor - A cella színe, nekünk ez most alapból Fekete lesz.</li>
<li>borderCellColor - A Board szélének a színe. Szeretnénk megkülönböztetni a pálya színétől.</li>
<li>gridWidth - A Board szélessége</li>
<li>gridHeight - A Board magassága</li>
</ul>
<p>A függvény belsejében kettő for ciklus található. Ennek a segítségével tudunk végig iterálni egy két dimenziós táblázaton. Az első for ciklus a Board szélességét kapja meg, a második pedig a magasságát. Ezen belül ellenőrizzük, hogy a Board széleit rajzoljuk-e ki vagy sem, majd ettől a változótól függően színezzük ki a rajzolt téglalapokat.</p>
<p><strong>DrawFood</strong></p>
<p>Folytatásként hozzuk létre a DrawFood nevű Kotlin File-t a food nevű Package-ban, majd a mellékelt kód alapján írjuk meg.</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="n">DrawScope</span><span class="p">.</span><span class="nf">drawFood</span><span class="p">(</span>
<span class="w">    </span><span class="n">foodImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">cellSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="n">coordinate</span><span class="p">:</span><span class="w"> </span><span class="n">Coordinate</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">drawImage</span><span class="p">(</span>
<span class="w">        </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">foodImage</span><span class="p">,</span>
<span class="w">        </span><span class="n">dstOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntOffset</span><span class="p">(</span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cellSize</span><span class="p">,</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">cellSize</span><span class="p">),</span>
<span class="w">        </span><span class="n">dstSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntSize</span><span class="p">(</span><span class="n">cellSize</span><span class="p">,</span><span class="w"> </span><span class="n">cellSize</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ez egy egyszerű függvény, amelynek a segítségével a megadott képet ki tudjuk rajzolni magán a pályán. Ez jelen esetben a Snake Food lesz. Ez három paramétert kap:</p>
<ul>
<li>foodImage - Egy ImageBitmap amely a Food képét tartalmazza</li>
<li>cellSize - Ez egy Int paraméter, amely a cella méretét adja át.</li>
<li>coordinate - Az a koordináta a pályán, ahova az adott képet ki kell rajzolnunk.</li>
</ul>
<p>A drawImage függvény segítségével ezt könnyen meg is tudjuk valósítani, csak meg kell adni az alábbi paramétereket. </p>
<p><strong>DrawSnake</strong></p>
<p>Ez a függvény egy kicsit összetettebb függvény lesz, ugyanis a kígyó kirajzolását sok szempont alapján kell megvalósítani. Első sorban szeretnénk, hogy a kígyó fordulásnál a megfelelő képet használja, valamint horizontális, és vertikális közlekedésnél is a megfelelő képet használja. Ezekhez segítséget fognak nyújtani az alábbi segédfüggvények. (BodyImage, IsTurn, TurnImage)</p>
<p>Kezdjük a BodyImage Kotlin Fileval.</p>
<h3 id="body-image">Body Image<a class="headerlink" href="#body-image" title="Permanent link">&para;</a></h3>
<p>Ez a függvény ki fogja nekünk számítani, hogy horizontális, vagy éppen vertikális kígyó testre van nekünk szükségünk.</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">getBodyImage</span><span class="p">(</span>
<span class="w">    </span><span class="n">index</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="n">snake</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Coordinate</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">bodyVerticalImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">bodyHorizontalImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span>
<span class="p">):</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prevDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">nextDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bodyVerticalImage</span><span class="w"> </span><span class="c1">// Both directions are vertical</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bodyHorizontalImage</span><span class="w"> </span><span class="c1">// Both directions are horizontal</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unexpected body segment at index </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Paraméterként megkapja az adott index-et amely a kígyónak egy részét jelöli a listában, valamint magát a listát is, illetve a két képet. Kiszámítjuk indexeléssel az előző-jelenlegi-következő koordinátákat, majd ezeknek a segítségével kiszámítjuk, hogy mi volt az előző, illetve a következő iránya a kígyónak. Ezt úgy tehetjük meg, hogy a jelenlegi koordinátából kivonjuk az előző koordinátákat:</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">prevDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>
</code></pre></div>
Valamint a következő irányt is ki tudjuk számolni, úgy, hogy a következő koordinátából kivonjuk a jelenlegit.</p>
<div class="highlight"><pre><span></span><code><span class="kd">val</span><span class="w"> </span><span class="nv">nextDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>
</code></pre></div>
<p>Ezután egy when elágazással visszaadjuk a megfelelő képet az alábbi kikötés szerint:</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">prevDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bodyVerticalImage</span><span class="w"> </span><span class="c1">// Both directions are vertical</span>
<span class="w">    </span><span class="n">prevDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bodyHorizontalImage</span><span class="w"> </span><span class="c1">// Both directions are horizontal</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unexpected body segment at index </span><span class="si">$</span><span class="n">index</span><span class="s">&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ahhoz, hogy kicsit érthetőbb legyen ez az algoritmus egy példán fogjuk demonstrálni. Képzeljük el az alábbi szituációt. A kígyó koordinátái:</p>
<ul>
<li>(2,2)</li>
<li>(2,3)</li>
<li>(2,4)</li>
<li>(3,4)</li>
<li>(4,4)</li>
</ul>
<p>Ez képen így nézne ki:</p>
<p align="center">
<a class="glightbox" href="./assets/snakeTurnExample.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/snakeTurnExample.png" width="250"></a>
</p>

<p>Mi úgy szeretnénk megvizsgálni, hogy a második indexet adjuk át a függvénynek indexként. Ez a következőt fogja eredményezni:</p>
<div class="highlight"><pre><span></span><code>prev = Coordinate(2, 3)
curr = Coordinate(2, 4)
next = Coordinate(3, 4)

Directions:  
prevDirection = Pair(2 - 2, 4 - 3) = Pair(0, 1) (vertical)
nextDirection = Pair(3 - 2, 4 - 4) = Pair(1, 0) (horizontal)
</code></pre></div>
<p>Ez ugyan Error-hoz vezetne, hogy ha így lefutna, ugyanis egy kép vagy vertikális állapotban vagy horizontálisban lehet. Mindkettő egyszerre nem lehet. Ezt a függvény hivásnál akadályozzuk meg, ugyanis ilyenkor egy olyan testrészről beszélünk ami egy fordulás. Ezt úgy zárjuk ki, hogy ellenőrizzük az adott indexet, hogy fordulás-e vagy sem.</p>
<p>Nézzük meg ugyanezt a példát az 1-es indexre:</p>
<p><div class="highlight"><pre><span></span><code>prev = Coordinate(2, 2)
curr = Coordinate(2, 3)
next = Coordinate(2, 4)

Directions:  
prevDirection = Pair(2 - 2, 3 - 2) = Pair(0, 1) (vertical)
nextDirection = Pair(2 - 2, 4 - 3) = Pair(0, 1) (vertical)
</code></pre></div>
Jól látható, hogy most mind a kettő vertical lett, ekkor a when elágazás Error dobás nélkül le fog futni.</p>
<p>Következő lépésnek valósítsuk meg az isTurn File tartalmát is.</p>
<h3 id="isturn">isTurn<a class="headerlink" href="#isturn" title="Permanent link">&para;</a></h3>
<p>Ezt a függvényt hasonló módon meg tudjuk valósítani az előzőhöz képest. Itt is szükségünk van az index-re illetve a snake listára.</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">isTurnSegment</span><span class="p">(</span><span class="n">index</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span><span class="w"> </span><span class="n">snake</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Coordinate</span><span class="o">&gt;</span><span class="p">):</span><span class="w"> </span><span class="kt">Boolean</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">snake</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prevDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">nextDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Check if there is a change in direction</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">            </span><span class="p">(</span><span class="n">prevDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">prevDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">            </span><span class="p">(</span><span class="n">nextDirection</span><span class="p">.</span><span class="na">first</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nextDirection</span><span class="p">.</span><span class="na">second</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Az előzővel megeggyezően ugyan azt hajtjuk végre a függvény első felében, majd a return-nál leellenőrizzük az alábbiakat. Az előzővel megeggyezően a kígyó koordinátái az alábbiak:</p>
<ul>
<li>(2,2)</li>
<li>(2,3)</li>
<li>(2,4)</li>
<li>(3,4)</li>
<li>(4,4)</li>
</ul>
<p align="center">
<a class="glightbox" href="./assets/snakeTurnExample.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/snakeTurnExample.png" width="250"></a>
</p>

<p>Vegyük ismét a második indexet példának. Ennek igazat kell visszaadnia, ugyanis ez egy fordulás.</p>
<p><div class="highlight"><pre><span></span><code>prev = Coordinate(2, 3)
curr = Coordinate(2, 4)
next = Coordinate(3, 4)

Directions:  
prevDirection = Pair(2 - 2, 4 - 3) = Pair(0, 1) (vertical)
nextDirection = Pair(3 - 2, 4 - 4) = Pair(1, 0) (horizontal)
</code></pre></div>
A return résznél 3 kritériumnak kell teljesülnie, hogy igaz értéket adjon vissza, ha ezek közül bármelyik sérül, akkor hamis értéket fog visszaadni az isTurnSegment függvény.</p>
<p>Itt jelen esetben a két változóra teljesülni fog, hogy nem egyenlő, az egyik paraméterük tartalmaz 0-át, ezáltal igaz értéket fog visszaadni.</p>
<p>Teszteljük le a második esetet is, amikor az index 1.</p>
<p><div class="highlight"><pre><span></span><code>prev = Coordinate(2, 2)
curr = Coordinate(2, 3)
next = Coordinate(2, 4)

Directions:  
prevDirection = Pair(2 - 2, 3 - 2) = Pair(0, 1) (vertical)
nextDirection = Pair(2 - 2, 4 - 3) = Pair(0, 1) (vertical)
</code></pre></div>
Hogy ha ezt az esetet nézzük, akkor eredményül mind a két érték megegyezik, ami által sérül az első kritérium, így hamis értéket fogunk visszakapni.</p>
<p>Végül valósítsuk meg a TurnImage kotlin filet is. Ez azért fog felelni, hogy a 8 lehetséges fordulási eset közül kiválassza a megfelelő fordulási képet. Ehhez nyissuk meg a fájlt, és másoljuk bele az alábbi kódot:</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">getTurnImage</span><span class="p">(</span>
<span class="w">    </span><span class="n">index</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">,</span>
<span class="w">    </span><span class="n">snake</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Coordinate</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">turnUpRightImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">turnUpLeftImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">turnDownRightImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">turnDownLeftImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span>
<span class="p">):</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">curr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="o">]</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snake</span><span class="o">[</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="o">]</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">prevDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">prev</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">nextDirection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="n">next</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">x</span><span class="p">,</span><span class="w"> </span><span class="n">next</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">curr</span><span class="p">.</span><span class="na">y</span><span class="p">)</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnUpRightImage</span><span class="w"> </span><span class="c1">// UP to RIGHT</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="o">-</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnUpLeftImage</span><span class="w">  </span><span class="c1">// UP to LEFT</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnDownRightImage</span><span class="w"> </span><span class="c1">// DOWN to RIGHT</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="o">-</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnDownLeftImage</span><span class="w"> </span><span class="c1">// DOWN to LEFT</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnDownLeftImage</span><span class="w"> </span><span class="c1">// RIGHT to UP</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnUpLeftImage</span><span class="w">   </span><span class="c1">// RIGHT to DOWN</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="o">-</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnDownRightImage</span><span class="w"> </span><span class="c1">// LEFT to UP</span>
<span class="w">        </span><span class="n">prevDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="o">-</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nextDirection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Pair</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">turnUpRightImage</span><span class="w">  </span><span class="c1">// LEFT to DOWN</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unexpected turn segment&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A függvény szintén megkapja az index-et, valamint a kígyónak a listáját, de ezen felül még 4 képet is. Ezek mindegyike felel kettő-kettő fordulási esetért. Az előző kettő algoritmussal megeggyezően a függvény eleje szinte teljesen ugyan az, csak a return változik. Ezt otthon egy példán érdemes levezetni, hogy mikor melyik hogyan értékelődik ki. :)</p>
<p>Végül most, hogy már megvannak a szükséges segédfüggvények valósítsuk meg a DrawSnake DrawScope-t is.</p>
<p><strong>DrawSnake</strong></p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="n">DrawScope</span><span class="p">.</span><span class="nf">drawSnake</span><span class="p">(</span>
<span class="w">    </span><span class="n">snakeHeadImage</span><span class="p">:</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">,</span>
<span class="w">    </span><span class="n">cellSize</span><span class="p">:</span><span class="w"> </span><span class="kt">Float</span><span class="p">,</span>
<span class="w">    </span><span class="n">snake</span><span class="p">:</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Coordinate</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">turnParts</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="o">&gt;</span><span class="p">,</span>
<span class="w">    </span><span class="n">bodyParts</span><span class="p">:</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="kt">String</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="o">&gt;</span>
<span class="p">){</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cellSize</span><span class="p">.</span><span class="na">toInt</span><span class="p">()</span>
<span class="w">    </span><span class="n">snake</span><span class="p">.</span><span class="na">forEachIndexed</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">coordinate</span><span class="w"> </span><span class="o">-&gt;</span>

<span class="w">        </span><span class="k">when</span><span class="p">{</span>
<span class="w">            </span><span class="c1">//SnakeHead Draw</span>


<span class="w">            </span><span class="c1">//SnakeTail Draw</span>


<span class="w">            </span><span class="c1">//Turn Segment Draw</span>


<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="c1">//Body Part Draw</span>

<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ennek a függvénynek a segítségével fogjuk a kígyót kirajzolni. A függvény továbbra is megkapja a kígyó listáját, emellett megkapja a kígyó fejéhez tartozó képet, a cellaméretet, valamint két Map-et amellyek a fordulóponthoz tartozó képeket tartalmazzák, valamint a kígyó testrészéhez tartozó képeket. </p>
<p>Itt az esetek száma 4-re bővül, ugyanis külön esetnek számít, hogy ha a kígyó fejét szeretnénk kirajzolni, vagy a farkát, vagy a testét, vagy egy olyan testrészt ami éppen fordulópontban van. Ez alapján egészítsük ki a kódunk kommentelt részeit.</p>
<p><strong>SnakeHead</strong></p>
<p>A kígyó feje akkor következik be, hogy ha az index==0-val. Gondoljuk végig, hogy miért. Nagyon egyszerű rá a válasz! :)</p>
<p><div class="highlight"><pre><span></span><code><span class="n">index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-&gt;</span><span class="p">{</span>
<span class="w">    </span><span class="n">drawImage</span><span class="p">(</span>
<span class="w">        </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeHeadImage</span><span class="p">,</span>
<span class="w">        </span><span class="n">dstOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntOffset</span><span class="p">(</span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">),</span>
<span class="w">        </span><span class="n">dstSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntSize</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Ez egy egyszerű drawImage függvény segítségével lesz megvalósítva mint korábban már láthattuk.</p>
<p><strong>SnakeTail</strong></p>
<p>A kígyó fejéhez hasonlóan itt is a szélső indexet kell néznünk, csak itt a lista végét. Ezt a <code>snake.index-1</code> segítségével tehetjük meg.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">index</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">snake</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">drawCircle</span><span class="p">(</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Green</span><span class="p">,</span>
<span class="w">        </span><span class="n">center</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Offset</span><span class="p">(</span>
<span class="w">            </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="na">toFloat</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span>
<span class="w">            </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="na">toFloat</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">radius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2f</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Jelen esetben kígyó farkonak csak egy zöld kört szeretnénk rajzolni, de ez később bármikor lecserélhető egyedi képre is.</p>
<p><strong>IsTurnSegment</strong></p>
<p>Mivel ez a függvény egy boolean-t ad vissza értékként, ezért ha true-ra értékelődik ki, akkor az elágazás törzsébe írt függvény fog végrehajtódni. Ehhez paraméterként át kell adnunk egy indexet, valamint a kígyó listáját.</p>
<p><div class="highlight"><pre><span></span><code><span class="n">isTurnSegment</span><span class="p">(</span><span class="n">index</span><span class="p">,</span><span class="w"> </span><span class="n">snake</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">drawImage</span><span class="p">(</span>
<span class="w">        </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getTurnImage</span><span class="p">(</span>
<span class="w">            </span><span class="n">index</span><span class="p">,</span>
<span class="w">            </span><span class="n">snake</span><span class="p">,</span>
<span class="w">            </span><span class="n">turnUpRightImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">turnParts</span><span class="o">[</span><span class="s">&quot;upright&quot;</span><span class="o">]!!</span><span class="p">,</span>
<span class="w">            </span><span class="n">turnUpLeftImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">turnParts</span><span class="o">[</span><span class="s">&quot;rightdown&quot;</span><span class="o">]!!</span><span class="p">,</span>
<span class="w">            </span><span class="n">turnDownRightImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">turnParts</span><span class="o">[</span><span class="s">&quot;downright&quot;</span><span class="o">]!!</span><span class="p">,</span>
<span class="w">            </span><span class="n">turnDownLeftImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">turnParts</span><span class="o">[</span><span class="s">&quot;downleft&quot;</span><span class="o">]!!</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">dstOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntOffset</span><span class="p">(</span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">),</span>
<span class="w">        </span><span class="n">dstSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntSize</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
A drawImage függvény, illetve a getTurnImage, valamint a Map segítségével kirajzoljuk a megfelelő fordulási képet. Emlékezzünk vissza, a getTurnImage függvénynek szüksége volt az indexre, a kígyó listájára, valamint 4 képre. Ezek mindegyike két-két opciót fed le a 8 közül. Ha ez kiértékelődik akkor a drawImage megkapja a megfelelő képet majd kirajzolja a kígyó testrészét.</p>
<p><strong>Body Part</strong></p>
<p>Ez az else elágazásba kerül, hogy ha egyik sem értékelődik ki True-ra. Ez akkor következik be, hogy ha a kígyó adott testrésze csak vertikális, vagy horizontális állapotban van. Így tudunk meggyőződni arról, hogy a korábban létrehozott <code>getBodyImage</code> függvény nem fog Errort dobni számunkra.</p>
<div class="highlight"><pre><span></span><code><span class="n">drawImage</span><span class="p">(</span>
<span class="w">    </span><span class="n">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getBodyImage</span><span class="p">(</span>
<span class="w">        </span><span class="n">index</span><span class="p">,</span>
<span class="w">        </span><span class="n">snake</span><span class="p">,</span>
<span class="w">        </span><span class="n">bodyVerticalImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyParts</span><span class="o">[</span><span class="s">&quot;up&quot;</span><span class="o">]!!</span><span class="p">,</span>
<span class="w">        </span><span class="n">bodyHorizontalImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyParts</span><span class="o">[</span><span class="s">&quot;right&quot;</span><span class="o">]!!</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">dstOffset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntOffset</span><span class="p">(</span><span class="n">coordinate</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">coordinate</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">),</span>
<span class="w">    </span><span class="n">dstSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IntSize</span><span class="p">(</span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></div>
<p>Most hogy már minden szükséges függvény, DrawScope meg van, el tudjuk kezdeni megírni a Game Screen kódját.</p>
<p>Mivel a játékterület 20 : 30 egység ezért a játék területnek adni kell egy &#8532;-os ratiot. Erre itt egy vizuális demonstráció.</p>
<p align="center">
<a class="glightbox" href="./assets/GameScreenRatio.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/GameScreenRatio.png" width="320"></a>
</p>

<p>Ezt a Modifier.aspectRatio(...) segítségével érhetjük el, amely úgy formázza a területet, hogy egységes legyen, és a megadott arány szerint legyenek a méretei.</p>
<p>A fenti eredmény sornak nem kell ilyet adni, ugyanis ez csak egy szimpla sor. Ennek elég egy .fillMaxWidth() függvény. Ezen a soron egy IconButton-Text-Spacer szerepel amelynek az arányai rendre: 1-10-1</p>
<p>A lenti vezérlőgombok elrendezését az alábbi minta szemlélteti:</p>
<p align="center">
<a class="glightbox" href="./assets/Controller.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img src="./assets/Controller.png" width="320"></a>
</p>

<ul>
<li>A külső bordó keretes téglalap egy Row. Az összes vezérlő gomb ezen belül van elhelyezve. </li>
<li>Ezen belül van 3 Column 1-2-1-es súlyozással. Így tudjuk elérni, hogy a középső szekció nagyobb mint a két szélső. </li>
<li>Az első és az utolsó oszlopban egy szimpla TextButton Composable van elhelyezve.</li>
<li>A középső oszlopon belül 3 Row van elhelyezve, ezeken belül a felépítés az alábbi módon történik:<ul>
<li>Az első sorban egy IconButton van elhelyezve</li>
<li>A második sorban kettő IconButton van elhelyezve, és ezek a sor két széléhez vannak rendezve.</li>
<li>A harmadik sorban hasonlóan az első sorhoz egyetlen gomb van elhelyezve.</li>
</ul>
</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">GameScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">,</span>
<span class="w">    </span><span class="n">onEvent</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">imageBitmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">food</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">snakeHeadBitmap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">direction</span><span class="p">){</span>
<span class="w">        </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">snakehead1</span><span class="p">)</span>
<span class="w">        </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">snakehead2</span><span class="p">)</span>
<span class="w">        </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">snakehead3</span><span class="p">)</span>
<span class="w">        </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">snakehead4</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">turnPartsMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;upright&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">upright</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;rightdown&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">rightdown</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;downright&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">downright</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;downleft&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">downleft</span><span class="p">))</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">bodyPartsMap</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;up&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">bodyup</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;down&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">bodydown</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;left&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">bodyleft</span><span class="p">)),</span>
<span class="w">        </span><span class="n">Pair</span><span class="p">(</span><span class="s">&quot;right&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ImageBitmap</span><span class="p">.</span><span class="na">imageResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">bodyright</span><span class="p">))</span>
<span class="w">    </span><span class="p">)</span>


<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//Score and Back Button Row</span>


<span class="w">        </span><span class="c1">//Canvas</span>


<span class="w">        </span><span class="c1">//Controllers</span>

<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A GameScreen kód skeletonja az alábbi kódblokkban láthat. A következőkben ezt fogjuk kiegészíteni az elvártaknak megfelelően.</p>
<p>A Composable függvényen belül látható két Map, illetve egy ImageBitmap változó. Ezekre létezik szebb megoldás, de a könnyebb megértés érdekében ezt választottuk. </p>
<p><strong>Score and Back Button Row</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="w">    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">IconButton</span><span class="p">(</span>
<span class="w">        </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//TODO: Navigate back</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">            </span><span class="n">imageVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Icons</span><span class="p">.</span><span class="na">AutoMirrored</span><span class="p">.</span><span class="na">Filled</span><span class="p">.</span><span class="na">ArrowBack</span><span class="p">,</span>
<span class="w">            </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">state</span><span class="p">.</span><span class="na">gameState</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;Paused&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="n">state</span><span class="p">.</span><span class="na">isGameOver</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;Game Over&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;Score: </span><span class="si">${</span><span class="n">state</span><span class="p">.</span><span class="na">snake</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">1</span><span class="si">}</span><span class="s">&quot;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span><span class="n">Font</span><span class="p">(</span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span><span class="p">)),</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">10f</span><span class="p">),</span>
<span class="w">        </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">Spacer</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
Mint már korábban is említettük, ez a sor három elemet fog tartalmazni. Egy IconButton-t, egy Text-et illetve egy Spacert 1-10-1-es súlyozási arányban. Ezt a <code>modifier.weight(..)</code>segítségével tudjuk elérni. Az IconButton-nak a működését már most be is állíthatjuk, hogy a megnyomását követően a főképernyőre kerüljünk:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ResetGame</span><span class="p">)</span>
<span class="w">    </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">popUpTo</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">inclusive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Szükségünk van arra, hogy a játék állapotát alaphelyzetbe állítsuk, ezt az onClick első sorával tehetjük meg, valamint a <code>navController.navigate(..){..}</code> lambda segítségével beállítjuk, hogy ha a felhasználó vissza gombot nyomna a főképernyőn ezután, ne tudjon visszanavigálni a játék képernyőjére. Ezt a <code>popUpTo(..){inclusive..}</code> segítségével tehetjük meg.</p>
<p>A Text felirata az alábbiaktól függ:</p>
<ul>
<li>Ha gameState == IDLE &amp;&amp; countBack &gt; 0 -&gt; A visszaszámlálót írja ki. (Ezzel később foglalkozunk, ezt még nem kell beleimplementálni)</li>
<li>Ha gameState == PAUSED -&gt; <em>Paused</em> felirat legyen</li>
<li>Ha gameState == GameOver -&gt; <em>Game Over</em> felirat legyen</li>
<li>Másképp -&gt; <em>Score: {score}</em><ul>
<li>A scoret, a kígyó hosszából tudjuk kiszámítani.</li>
</ul>
</li>
</ul>
<p><strong>Canvas</strong></p>
<p><div class="highlight"><pre><span></span><code><span class="n">Canvas</span><span class="p">(</span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">    </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">aspectRatio</span><span class="p">(</span><span class="m">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">3f</span><span class="p">)</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">drawBoard</span><span class="p">(</span>
<span class="w">        </span><span class="n">cellSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="na">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">        </span><span class="n">cellColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">borderCellColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">DarkGray</span><span class="p">,</span>
<span class="w">        </span><span class="n">gridWidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">xSize</span><span class="p">,</span>
<span class="w">        </span><span class="n">gridHeight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">ySize</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">drawFood</span><span class="p">(</span>
<span class="w">        </span><span class="n">foodImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">imageBitmap</span><span class="p">,</span>
<span class="w">        </span><span class="n">cellSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="na">width</span><span class="p">.</span><span class="na">toInt</span><span class="p">()</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">        </span><span class="n">coordinate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">food</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="n">drawSnake</span><span class="p">(</span>
<span class="w">        </span><span class="n">snakeHeadImage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeHeadBitmap</span><span class="p">,</span>
<span class="w">        </span><span class="n">cellSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">.</span><span class="na">width</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">20</span><span class="p">,</span>
<span class="w">        </span><span class="n">snake</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">snake</span><span class="p">,</span>
<span class="w">        </span><span class="n">turnParts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">turnPartsMap</span><span class="p">,</span>
<span class="w">        </span><span class="n">bodyParts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyPartsMap</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
A Canvas-hez tartozó kódrészlet meglehetőssen kicsi, viszont emlékezzünk vissza, emögött egy nagyon sok függvényt, DrawScopet definiáltunk :)!</p>
<p>A korábban megírt DrawScope-k használatával először kirajzoljuk a játék pályát, majd erre rárajzoljuk az almát, és utána a kígyót. </p>
<div class="admonition danger">
<p class="admonition-title">SORREND!</p>
<p><strong>Nagyon fontos a sorrend, ugyanis ezek az elemek egymást fedik, és ha a pálya rajzolást raknánk legutoljára, nem látnánk a többi elemet ami fölötte van!</strong></p>
</div>
<p>Hogy ha ezzel megvagyunk következőnek megvalósítjuk a Controller részét. Ez egy hosszabb kód lesz, ezért előre is elnézést kérünk!</p>
<div class="highlight"><pre><span></span><code><span class="n">Row</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="c1">//Column 1</span>

<span class="w">    </span><span class="c1">//Column 2</span>

<span class="w">    </span><span class="c1">//Column 3</span>

<span class="p">}</span>
</code></pre></div>
<ul>
<li>
<p><strong>Column 1</strong></p>
<ul>
<li>Horizontal, Vertical - Center</li>
<li>Modifier<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes teret (fillMaxSize)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Column</span><span class="p">(</span>
<span class="w">    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">    </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//TextButton 1</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>TextButton 1</strong></p>
<ul>
<li>onClick:<ul>
<li>IDLE -&gt; Start Game</li>
<li>STARTED -&gt; Pause Game</li>
<li>PAUSED -&gt; Start Game (Resume)</li>
</ul>
</li>
<li>Modifier<ul>
<li>Töltse ki a teljes teret
<div class="highlight"><pre><span></span><code><span class="n">TextButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">gameState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">IDLE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="p">)</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">PauseGame</span><span class="p">)</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">gameState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">IDLE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Start&quot;</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Pause&quot;</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Resume&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span>
<span class="w">            </span><span class="n">Font</span><span class="p">(</span>
<span class="w">                </span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span><span class="w">    </span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Column 2</strong></p>
<ul>
<li>Horizontal, Vertical - Center</li>
<li>Modifier<ul>
<li>2-es súlyozás (weight)</li>
<li>Töltse ki a teljes teret (fillMaxSize)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Column</span><span class="p">(</span>
<span class="w">    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">    </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//Row 2.1</span>

<span class="w">    </span><span class="c1">//Row 2.2</span>

<span class="w">    </span><span class="c1">//Row 2.3</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Látható, hogy a korábban beszúrt képpel megegyeznek a kommentek, ide kell majd megvalósítani az előzőhöz hasonlóan a többi Composable elemeket. Folytassuk a 3 Sor beszúrásával a következő képpen:</p>
<ul>
<li>
<p><strong>Row 2.1</strong></p>
<ul>
<li>Vertical, Horizontal - Center</li>
<li>Modifier<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes <strong>szélességet</strong> (fillMaxWidth)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Row</span><span class="p">(</span>
<span class="w">    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//IconButton 2.1.1</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>IconButton 2.1.1</strong></p>
<ul>
<li>onClick:<ul>
<li>Irányváltás felfelé (<code>onEvent(SnakeEvent.ChangeDir(Direction.UP))</code>)</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Háttér legyen szürke (<code>.background(Color.Gray)</code>)
<div class="highlight"><pre><span></span><code><span class="n">IconButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="p">(</span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span><span class="p">))</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">60.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">60.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="m">0f</span><span class="p">),</span>
<span class="w">        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">arrow</span><span class="p">),</span>
<span class="w">        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Az IconButton törzsében egy Icon Composablet helyezünk el, melynek a segítségével megjelenítjük a megfelelő vezérlőikont. Fontos, hogy egyetlen képet használunk a négy vezérlő Icon-ra, ugyanis a <code>Modifier.rotate(..)</code> segítségével el tudjuk forgatni a megfelelő irányba őket.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Row 2.2</strong></p>
<ul>
<li>Vertical - Center</li>
<li>Horizontal - SpaceBetween (Ennek köszönhetően a benne lévő 2 elem a Row két szélére kerül)</li>
<li>Modifier:<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes <strong>szélességet</strong> (fillMaxWidth)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Row</span><span class="p">(</span>
<span class="w">    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">SpaceBetween</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//IconButton 2.2.1</span>

<span class="w">    </span><span class="c1">//IconButton 2.2.2</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>IconButton 2.2.1</strong></p>
<ul>
<li>onClick:<ul>
<li>Irányváltás balra (<code>onEvent(SnakeEvent.ChangeDir(Direction.LEFT))</code>)</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Háttér legyen szürke (<code>.background(Color.Gray)</code>)
<div class="highlight"><pre><span></span><code><span class="n">IconButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="p">(</span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span><span class="p">))</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">60.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">60.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="o">-</span><span class="m">90f</span><span class="p">),</span>
<span class="w">        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">arrow</span><span class="p">),</span>
<span class="w">        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Itt látható, hogy az IconButton törzsében lévő Icon-nak ugyanazt a képet adtuk mint az előző esetben, csak egy -90°-os forgatást ráraktunk még, ezzel elérve azt, hogy balra el legyen forgatva.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>IconButton 2.2.2</strong></p>
<ul>
<li>onClick:<ul>
<li>Irányváltás jobbra (<code>onEvent(SnakeEvent.ChangeDir(Direction.RIGHT))</code>)</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Háttér legyen szürke (<code>.background(Color.Gray)</code>)
<div class="highlight"><pre><span></span><code><span class="n">IconButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="p">(</span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">))</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">60.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">60.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="m">90f</span><span class="p">),</span>
<span class="w">        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">arrow</span><span class="p">),</span>
<span class="w">        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Az előzőhöz hasonlóan ugyanúgy megkapta az <em>arrow</em> .png képet, csak itt egy +90°-os forgatást kapott, így jobbra néz a vezérlőnk.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Row 2.3</strong></p>
<ul>
<li>Vertical, Horizontal - Center</li>
<li>Modifier:<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes <strong>szélességet</strong> (fillMaxWidth)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Row</span><span class="p">(</span>
<span class="w">    </span><span class="n">verticalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterVertically</span><span class="p">,</span>
<span class="w">    </span><span class="n">horizontalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">//IconButton 2.3.1</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>IconButton 2.3.1</strong></p>
<ul>
<li>onClick:<ul>
<li>Irányváltás lefelé (<code>onEvent(SnakeEvent.ChangeDir(Direction.DOWN))</code>)</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Háttér legyen szürke (<code>.background(Color.Gray)</code>)
<div class="highlight"><pre><span></span><code><span class="n">IconButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="p">(</span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span><span class="p">))</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">),</span>

<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Icon</span><span class="p">(</span>
<span class="w">        </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="m">60.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="m">60.</span><span class="n">dp</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">rotate</span><span class="p">(</span><span class="m">180f</span><span class="p">),</span>
<span class="w">        </span><span class="n">tint</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">painter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">painterResource</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">R</span><span class="p">.</span><span class="na">mipmap</span><span class="p">.</span><span class="na">arrow</span><span class="p">),</span>
<span class="w">        </span><span class="n">contentDescription</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Végül az utolsó vezérlőgombnak is átadjuk a képet, egy 180°-os elforgatással. Már csak az utolsó oszlop van hátra, és végzünk is a vezérlőgombokkal.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Column 3</strong></p>
<ul>
<li>Vertical, Horizontal - Center</li>
<li>Modifier<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes teret (fillMaxSize)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Column</span><span class="p">(</span>
<span class="w">    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">    </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//TextButton 3.2</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>TextButton 3.2</strong></p>
<ul>
<li>onClick:<ul>
<li>Restart Game (<code>onEvent(SnakeEvent.ResetGame)</code>)</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Töltse ki a teljes teret (fillMaxSize)
<div class="highlight"><pre><span></span><code><span class="n">TextButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ResetGame</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">isGameOver</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Restart&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;New Game&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span>
<span class="w">            </span><span class="n">Font</span><span class="p">(</span>
<span class="w">                </span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">textAlign</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TextAlign</span><span class="p">.</span><span class="na">Center</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
A TextButton törzsében elhelyezett Text Composable két értéket fog megjeleníteni az állapottól függően. Hogy ha Game Over állapotban van a játéko akkor <em>Game Over</em> felirat, másképp pedig <em>New Game</em> feliratot.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Ezzel el is készült a vezérlőnk teljesen. Most már csak pár lépés van hátra, hogy tesztelhessük a teljes alkalmazást az új UI-val, illetve a Snake logikával. Ehhez módosítsuk a <code>NavGraph</code>-ot, úgy hogy paraméterként hozzáveszünk még 2 értéket. Ezek a <code>SnakeState</code>, illetve a <code>SnakeViewModel</code> paraméterek lesznek:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">(),</span>
<span class="w">    </span><span class="n">startDestination</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mainscreen&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">(),</span>
<span class="w">    </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div>
<p>Ezután a <code>NavHost</code> Composable belsejében lévő <code>gameScreen</code>-re mutató irányt módosítsuk az alábbiak szerint:</p>
<ul>
<li>Két változót létre kell hoznunk, amely a <code>name</code> illetve a <code>difficulty</code> értéket fogja tárolni. Ezeket a változókat ki tudjuk szedni a navArgumentekből az alábbi módon:<ul>
<li><code>it.arguments?.getString(...)</code></li>
</ul>
</li>
<li>Hogy ha meg van a két változónk, azoknak a segítségével be kell állítanunk a viewModel értékeit a következők szerint:<ul>
<li>setPlayerName - name</li>
<li>setGameDifficulty - difficulty</li>
</ul>
</li>
</ul>
<p>Erre segítségül adunk egy kódot, amivel könnyen meg tudjátok csinálni.</p>
<div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;gameScreen/{playerName}/{difficulty}&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">listOf</span><span class="p">(</span>
<span class="w">        </span><span class="n">navArgument</span><span class="p">(</span><span class="s">&quot;playerName&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavType</span><span class="p">.</span><span class="na">StringType</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="n">navArgument</span><span class="p">(</span><span class="s">&quot;difficulty&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NavType</span><span class="p">.</span><span class="na">StringType</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">arguments</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;playerName&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">difficulty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">arguments</span><span class="o">?.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;difficulty&quot;</span><span class="p">)</span><span class="o">?.</span><span class="na">toGameDifficulty</span><span class="p">()</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">.</span><span class="na">setPlayerName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">.</span><span class="na">setGameDifficulty</span><span class="p">(</span><span class="n">difficulty</span><span class="p">)</span>
<span class="w">    </span><span class="n">GameScreen</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">,</span>
<span class="w">        </span><span class="n">onEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="o">::</span><span class="n">onEvent</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>A módosított irány az alábbi módon néz ki. Jól láthato, hogy a <code>composable(..){..}</code> törzsében a változókban eltároljuk az értékeket, majd ezek segítségével a snakeViewModel értékeit beállítjuk, végül átadjuk a szükséges paramétereket a GameScreen Composable függvényünknek. Azonban szükségünk van egy saját függvényre, amely a String-es játéknehézséget GameDifficulty Enum Class-ba alakítja át. Ehhez vegyünk fel egy új függvényt a <code>StartGameScreen</code> fájlunkba, az Enum Class-unk alá:</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="nf">toGameDifficulty</span><span class="p">():</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">when</span><span class="p">(</span><span class="k">this</span><span class="p">){</span>
<span class="w">        </span><span class="s">&quot;EASY&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span>
<span class="w">        </span><span class="s">&quot;MEDIUM&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">MEDIUM</span>
<span class="w">        </span><span class="s">&quot;HARD&quot;</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">HARD</span>
<span class="w">        </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">GameDifficulty</span><span class="p">.</span><span class="na">EASY</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ez egy egyszerű függvény, amely egy String-en hívható meg, és ezt a String-et átalakítja az osztály egy elemévé a Stringtől függően.</p>
<p>Ahhoz, hogy az alkalmazásunk hiba nélkül futtatható legyen, még módosítanunk kell a <code>MainNavScreen</code>, illetve a <code>MainActivity</code> Kotlin Filekat, ugyanis a MainActivity-ből át kell adnunk a snakeViewModel-t egésszen a NavHost-ig, amit úgy tudunk egyelőre elérni, hogy egyesével átadjuk paraméterként. Ehhez módosítsuk a <code>MainNavScreen</code>-t a következők szerint:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">MainNavScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span>
<span class="p">){</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">title</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">title</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">(</span><span class="s">&quot;Snake&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">navigationLambda</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">navigate</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">()</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">showBackArrow</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">showBackArrow</span><span class="p">.</span><span class="na">observeAsState</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">innerPadding</span><span class="w"> </span><span class="o">-&gt;</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">()</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="p">.</span><span class="na">state</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">()</span>

<span class="w">        </span><span class="n">NavGraph</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">innerPadding</span><span class="p">),</span>
<span class="w">            </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">            </span><span class="n">snakeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Majd végül a módosítást végrehajtjuk a <code>MainActivity</code>-n is.</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModels</span><span class="p">()</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">viewModels</span><span class="p">()</span>
<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span><span class="w"> </span><span class="n">Bundle?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">MainNavScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span>
<span class="p">)</span>
</code></pre></div>
<p>Ha mindent jól csináltunk, a játéknak működnie kellene az elindítás után! :)</p>
<p>Próbálj meg összeszedni 5 pontot, majd lescreenshotolni és azt beadni feladatmegoldásként!</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (4 pont)</p>
<p>Készíts <strong>képernyő képet</strong> a játékról, amelyen látszik az <strong>elkészült oldal, valahány pont a játék során vagy a gameOver felirat</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f4.png néven töltsd föl.</p>
</div>
<h2 id="high-scores-database-2-pont">High Scores / Database (2 pont)<a class="headerlink" href="#high-scores-database-2-pont" title="Permanent link">&para;</a></h2>
<p>A következő feladatban az adabázis részét fogjuk megvalósítani az alkalmazásnak, ennek a segítségével tudjuk elérni, hogy a játék végén, egy adatbázisba elmentsük a játék adatait (Név, pont, nehézség formában). Ehhez szükségünk lesz egy <strong>Dao</strong>-ra, egy <strong>DataBase</strong>-re, illetve egy <strong>Entity</strong>-re is. Ezeknek a segítségével fogjuk elvégezni az adatok tárolását, valamint az adatbázis adatainak a módosítását.</p>
<p>Először hozzunk létre egy új Packaget a gyökérmappában <code>data</code> néven. Korábban a labor elején már hozzáadtuk a szükséges függőségeket, így most könnyen elkezdhetjük a kódunk megírását, illetve az adatbázis felépítését. </p>
<h3 id="dao">Dao<a class="headerlink" href="#dao" title="Permanent link">&para;</a></h3>
<p>A következő lépés, hogy az entitáshoz kapcsolódó alapműveleteket is támogassuk a Room könyvtár segítségével. Ezt egy DAO (Data Access Object) komponenssel fogjuk megvalósítani. A DAO egy - szintén nem csak Android alatt alkalmazott - tervezési minta, amelynek a lényege, hogy az egy entitáshoz kapcsolódó összes adatbázisműveleteket egy komponensbe gyűjtjük össze. Ez egyrészt jól áttekinthető, illetve ha az adatbázist le szeretnénk cserélni más technológiára, akkor elvileg elegendő lenne a DAO komponens módosítása, bár ilyen jellegű módosításra manapság általában nincs szükség.</p>
<p>Hozzunk létre egy <code>data.dao</code> package-et, és ebben hozzunk létre egy <code>TopScoresDao</code> interfacet, majd vegyük fel az alábbit:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Dao</span>
<span class="kd">interface</span><span class="w"> </span><span class="nc">TopScoreDao</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Query</span><span class="p">(</span><span class="s">&quot;SELECT * FROM topscore ORDER BY score DESC&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getAll</span><span class="p">():</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">TopScore</span><span class="o">&gt;&gt;</span>

<span class="w">    </span><span class="nd">@Insert</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">topScore</span><span class="p">:</span><span class="w"> </span><span class="n">TopScore</span><span class="p">)</span>

<span class="w">    </span><span class="nd">@Update</span>
<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">topScore</span><span class="p">:</span><span class="w"> </span><span class="n">TopScore</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Láthatjuk, hogy egyrészt maga az interfész is meg van jelölve, mint DAO komponens, másrészt az egyes műveleteken is Room annotációk vannak. A Room az annotációból, illetve az annotált metódus paramétereiből és visszatérési értékéből ki tudja következtetni a szándékunkat.</p>
<p>Ezután egy repository komponenst készítünk. Ez némileg úgy tűnik, mintha nem adna hozzá túl sokat a DAO-hoz, azonban fontos célja, hogy a felsőbb rétegeket függetlenítse a Roomtól, hogy ne közvetlen attól függjenek. </p>
<h3 id="entity">Entity<a class="headerlink" href="#entity" title="Permanent link">&para;</a></h3>
<p>Készítsünk el egy <code>data.entity</code> Packaget, majd ebben hozzunk létre egy új Kotlin File-t <code>TopScore</code> néven, majd vegyük fel az alábbi kódot:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Entity</span><span class="p">(</span><span class="n">tableName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;topscore&quot;</span><span class="p">)</span>
<span class="kd">data</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">TopScore</span><span class="p">(</span>
<span class="w">    </span><span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;id&quot;</span><span class="p">)</span><span class="w"> </span><span class="nd">@PrimaryKey</span><span class="p">(</span><span class="n">autoGenerate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">id</span><span class="p">:</span><span class="w"> </span><span class="kt">Long?</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;difficulty&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">difficulty</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@ColumnInfo</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;score&quot;</span><span class="p">)</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">score</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span>
<span class="p">)</span>
</code></pre></div>
<p>Látható, hogy itt is használtuk a Room Annotációkat, mégpedig a <code>ColumnInfo</code>-t. Ennek a segítségével hozunk létre új oszlopokat, az adott táblában, majd megadjuk az egyes oszlopok neveit. Az első oszlopra rárakjuk a <code>PrimaryKey</code> annotációt, amellyel megmondjuk az adatbázisnak, hogy automatikussan generáljon egy azonosítót az egyes elemeknek.</p>
<h3 id="database">DataBase<a class="headerlink" href="#database" title="Permanent link">&para;</a></h3>
<p>Utolsó lépésként hozzuk létre a DataBase osztályt. Ehhez hozzuk létre az alábbi Packaget - <code>data.database</code>, majd ebben egy <code>TopScoreDatabase</code> Kotlin file-t és írjuk bele az alábbit:</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@Database</span><span class="p">(</span><span class="n">entities</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="n">TopScore</span><span class="o">::</span><span class="n">class</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span>
<span class="kd">abstract</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="nc">TopScoreDatabase</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">RoomDatabase</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">abstract</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">topScoreDao</span><span class="p">():</span><span class="w"> </span><span class="n">TopScoreDao</span>

<span class="w">    </span><span class="n">companion</span><span class="w"> </span><span class="n">object</span><span class="p">{</span>
<span class="w">        </span><span class="nd">@Volatile</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">INSTANCE</span><span class="p">:</span><span class="w"> </span><span class="n">TopScoreDatabase? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>

<span class="w">        </span><span class="kd">fun</span><span class="w"> </span><span class="nf">getDatabase</span><span class="p">(</span><span class="n">context</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">):</span><span class="w"> </span><span class="n">TopScoreDatabase</span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">INSTANCE</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="n">synchronized</span><span class="p">(</span><span class="k">this</span><span class="p">){</span>
<span class="w">                </span><span class="n">Room</span><span class="p">.</span><span class="na">databaseBuilder</span><span class="p">(</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">TopScoreDatabase</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;topscore_database&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">fallbackToDestructiveMigration</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">also</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">INSTANCE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Ez az osztály egy Abstract osztály lesz, és szintén megkapja a Room egy annotációját, mégpedig a <code>Database</code> annotációt. Ez fogja jelezni, hogy itt egy adatbázis helyezkedik el az annotáció alatt. Az adatbázisnak egy verziót is adnunk kell, erre azért van szükség, hogy ha később változtatjuk a felépítését, akkor itt lehessen új verziót megadni. Ahhoz, hogy tudjuk használni az adatbázisunkat módosítani kell egy pár fájlt. Ezek rendre:</p>
<ol>
<li><strong>Application.kt</strong></li>
<li>MainActivity.kt</li>
<li>SnakeViewModel.kt</li>
<li>AndroidManifest.xml</li>
<li><strong>AppModule.kt</strong></li>
</ol>
<p>Ezek közül kettő még nem lett létrehozva. Ezekre azért van szükség, hogy használhassuk a Dependency Injectiont. Első sorban módosítsuk a <code>SnakeViewModel.kt</code> fájlt, úgy, hogy használja a HiltViewModel annotációt. Ehhez nyissuk meg a ViewModel osztályunkat, és módosítsuk a következők szerint:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@HiltViewModel</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SnakeViewModel</span><span class="w"> </span><span class="nd">@Inject</span><span class="w"> </span><span class="k">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">topScoreDao</span><span class="p">:</span><span class="w"> </span><span class="n">TopScoreDao</span>
<span class="p">):</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">(){</span>

<span class="w">    </span><span class="c1">//Top Scores</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">topScores</span><span class="p">:</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">TopScore</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topScoreDao</span><span class="p">.</span><span class="na">getAll</span><span class="p">()</span>

<span class="w">    </span><span class="c1">//PlayerName (Delete Previous)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_playerName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">playerName</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">String</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_playerName</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="c1">//...</span>

<span class="w">    </span><span class="c1">//Set Player Name</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setPlayerName</span><span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="p">){</span>
<span class="w">        </span><span class="n">_playerName</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">name</span>
<span class="w">    </span><span class="p">}</span>


<span class="w">    </span><span class="c1">//..</span>

<span class="w">    </span><span class="c1">//Game Update</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">updateGame</span><span class="p">(</span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//...</span>

<span class="w">        </span><span class="c1">//GAME OVER - SNAKE HIT ITSELF OR WALL</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="c1">//...</span>
<span class="w">        </span><span class="p">){</span>
<span class="w">            </span><span class="c1">//DATABASE INSERT</span>
<span class="w">            </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">topScoreDao</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span>
<span class="w">                    </span><span class="n">TopScore</span><span class="p">(</span>
<span class="w">                        </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">playerName</span><span class="p">.</span><span class="na">value</span><span class="p">,</span>
<span class="w">                        </span><span class="n">score</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">snake</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="p">,</span>
<span class="w">                        </span><span class="n">difficulty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gameDifficulty</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">toString</span><span class="p">()</span>
<span class="w">                    </span><span class="p">)</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">copy</span><span class="p">(</span><span class="n">isGameOver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//...</span>

<span class="p">}</span>
</code></pre></div>
<p>A fenti kódban, módosítottuk a viewModelt olyan szinten, hogy már megkapta a Hilt annotációját, valamint egy paramétert is kapott. Ez a Dao lesz, amit jelenleg a programunk nem fog tudni értelmezni, ugyanis ehhez létre kell hozunk egy <code>AppModule</code> fájlt, amiben leírjuk, hogy milyen módon kell előállítania ezt a paramétert.</p>
<p>Ehhez hozzunk létre egy új Packaget <code>di</code> néven, majd ebben egy új Kotlin Filet, <code>AppModule</code> néven, és töltsük ki a következővel:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="n">SingletonComponent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">AppModule</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Provides</span>
<span class="w">    </span><span class="nd">@Singleton</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">provideTopScoreDao</span><span class="p">(</span><span class="nd">@ApplicationContext</span><span class="w"> </span><span class="n">appContext</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">):</span><span class="w"> </span><span class="n">TopScoreDao</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">TopScoreDatabase</span><span class="p">.</span><span class="na">getDatabase</span><span class="p">(</span><span class="n">appContext</span><span class="p">).</span><span class="na">topScoreDao</span><span class="p">()</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Az AppModule objektumon belül rakunk két annotációt a <code>provideTopScoreDao</code> függvény-re, amely majd egy TopScoreDao objektumot ad vissza a meghívás után. Mivel <code>ApplicationContext</code>-et tud biztosítani, így ennek a segítségével meghívjuk a <code>getDatabase</code> függvényt ezzel a paraméterrel, majd legkérdezzük a Dao-t, így megkapva a szükséges paraméterünket.</p>
<p>Ahhoz, hogy a Dependency Injectionunk működjön globálisan az alkalmazás szintjén inicializálnunk kell a Daggert, hogy létrejöjjön egy kontextus, amelyben a függőségeket menedzseli. Ehhez hozzunk létre a gyökérmappában egy új Kotlin File-t <code>Application</code> néven, majd írjuk bele a következő egyszerű kódot:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@HiltAndroidApp</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MyApplication</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">Application</span><span class="p">()</span>
</code></pre></div>
<p>Azonban ahhoz, hogy ez működjön a Manifest állományt módosítanunk kell úgy, hogy ez az Application be legyen regisztrálva mint Application. Ehhez nyissuk meg és módosítsuk a következőek szerint:</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;manifest</span><span class="w"> </span><span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
<span class="w">    </span><span class="na">xmlns:tools=</span><span class="s">&quot;http://schemas.android.com/tools&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;application</span>
<span class="w">        </span><span class="na">android:name=</span><span class="s">&quot;.MyApplication&quot;</span>

<span class="w">        </span><span class="err">...</span>

<span class="w">        </span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;activity</span>
<span class="w">            </span><span class="err">...</span>
<span class="w">            </span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;intent-filter&gt;</span>
<span class="w">                </span>...
<span class="w">            </span><span class="nt">&lt;/intent-filter&gt;</span>
<span class="w">        </span><span class="nt">&lt;/activity&gt;</span>
<span class="w">    </span><span class="nt">&lt;/application&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<p>Most már csak egy annotációt kell rárakni a MainActivity-re, hogy az adatbázis mentés sikeres legyen. Azonban ahhoz, hogy az eremdények láthatóak legyenek a HighScore Screen-en még pár lépés hátra van.</p>
<p>Első sorban módosítsuk a MainActivity-nket úgy, hogy megkapja az <code>AndroidEntryPoint</code> Hilt annotációt:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@AndroidEntryPoint</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div>
<p>Végül módosítsuk úgy a <code>HighScoreScreen</code> file-t hogy használja ezt az adatbázist. Ehhez nyissuk meg a file-t majd modósítsuk a következőek szerint:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">HighScoresScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">highScores</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="p">.</span><span class="na">topScores</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">(</span><span class="n">listOf</span><span class="p">())</span>

<span class="w">    </span><span class="n">Column</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="c1">//...</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">//...</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">LazyColumn</span><span class="w"> </span><span class="p">(</span>
<span class="w">            </span><span class="c1">//...</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">items</span><span class="p">(</span><span class="n">highScores</span><span class="p">.</span><span class="na">value</span><span class="p">.</span><span class="na">size</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">index</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">Row</span><span class="w"> </span><span class="p">(</span>
<span class="w">                    </span><span class="c1">//...</span>
<span class="w">                </span><span class="p">){</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="p">.</span><span class="na">value</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">name</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="p">.</span><span class="na">value</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">score</span><span class="p">.</span><span class="na">toString</span><span class="p">(),</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">))</span>
<span class="w">                    </span><span class="n">TableText</span><span class="p">(</span><span class="n">highScores</span><span class="p">.</span><span class="na">value</span><span class="o">[</span><span class="n">index</span><span class="o">]</span><span class="p">.</span><span class="na">difficulty</span><span class="p">,</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">2f</span><span class="p">))</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A korábban használt highScores statikus változót lecseréljük egy újabb változóra, ami már a viewModel topScore paraméterét használja, majd végül módosítjuk a további paramétereket a használatukhoz megfelelően. Ezzel el is készült a Screen, már csak a snakeViewModel paramétert kell átadnunk a NavGraph-on belüli hívásnál:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NavHost</span><span class="p">(</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">){</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">        </span><span class="n">composable</span><span class="p">(</span><span class="s">&quot;highscores&quot;</span><span class="p">){</span>
<span class="w">            </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;High Scores&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">            </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">setNavigationLambda</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">            </span><span class="n">HighScoresScreen</span><span class="p">(</span>
<span class="w">                </span><span class="n">snakeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (2 pont)</p>
<p>Készíts <strong>képernyő képet</strong> a HighScoreScreenről, amelyen látszik az <strong>elkészült oldal, valahány mentett rekord, köztük a NEPTUN kódod egy játékosnévként</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f5.png néven töltsd föl.</p>
</div>
<h2 id="sensor-control-2-pont">Sensor Control (2 pont)<a class="headerlink" href="#sensor-control-2-pont" title="Permanent link">&para;</a></h2>
<p>Ebben a feladatban meg fogjuk valósítani, azt a fajta működését a játékunknak, hogy a felhasználó a telefon döntögetésével tudja irányítani a kígyót a megfelelő irányba.</p>
<p>Ehhez a következő lépéseket kell megvalósítani:</p>
<ol>
<li>SnakeViewModel módosítása</li>
<li>SettingsViewModel létrehozása</li>
<li>SettingsScreen módosítása</li>
<li>NavGraph</li>
<li>MainNavScreen</li>
<li>MainActivity</li>
<li>AppModule</li>
<li>PreferenceStorage</li>
</ol>
<p>Első sorban hozzunk létre egy <code>PreferenceStorage</code> nevű Kotlin Filet, a <code>data</code> mappában, majd a következőt használjuk fel a megírására:</p>
<div class="highlight"><pre><span></span><code><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">Context</span><span class="p">.</span><span class="na">dataStore</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">preferencesDataStore</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;settings&quot;</span><span class="p">)</span>

<span class="kd">class</span><span class="w"> </span><span class="nc">PreferenceStorage</span><span class="p">(</span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">context</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">companion</span><span class="w"> </span><span class="kd">object</span><span class="w"> </span><span class="err">{</span>
<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">SENSOR_CONTROL_KEY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">booleanPreferencesKey</span><span class="p">(</span><span class="s">&quot;sensor_control&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="p">:</span><span class="w"> </span><span class="n">Flow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">dataStore</span><span class="p">.</span><span class="na">data</span>
<span class="w">        </span><span class="p">.</span><span class="na">map</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">SENSOR_CONTROL_KEY</span><span class="o">]</span><span class="w"> </span><span class="o">?:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="kd">suspend</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">setSensorControlled</span><span class="p">(</span><span class="n">isSensorControlled</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">context</span><span class="p">.</span><span class="na">dataStore</span><span class="p">.</span><span class="na">edit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">preferences</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">preferences</span><span class="o">[</span><span class="n">SENSOR_CONTROL_KEY</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSensorControlled</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ez a kódrészlet egy Kotlin alkalmazásban lévő adatmegőrző rendszer működését mutatja be, amelyet az Android <code>DataStore</code> API-jával valósítanak meg. A <code>PreferenceStorage</code> osztály a <code>Context</code>-et használja a beállítások mentéséhez és lekéréséhez. Egy <code>Flow</code>-val tér vissza, amely figyeli a <code>sensor_control</code> nevű preferencia változásait, és alapértelmezésben <code>false</code>-t ad vissza, ha a beállítás még nem létezik. A <code>setSensorControlled</code> függvény lehetővé teszi, hogy egy új értéket állítsunk be ehhez a kulcshoz aszinkron módon.</p>
<p>Ezután hozzuk létre az új ViewModellünket. A <code>model</code> mappán belül készítsünk egy <code>settings</code> mappát, és ezen belül hozzunk létre egy új Kotlin Filet. Majd írjuk meg a kódot az alábbiak alapján:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@HiltViewModel</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">SettingsViewModel</span><span class="w"> </span><span class="nd">@Inject</span><span class="w"> </span><span class="k">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">preferenceStorage</span><span class="p">:</span><span class="w"> </span><span class="n">PreferenceStorage</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isSensorControlled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isSensorControlled</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="w">    </span><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//Collect Pref Storage</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">//setSensorControlled</span>
<span class="p">}</span>
</code></pre></div>
<p>A SettingsViewModellünk az alábbi módon fog kinézni. Itt is szükségünk van a Dependency Injection használatára, hogy a viewModel megkapja a PreferenceStorage példányt, amelyből ki fogja nyerni azt az információt, hogy a beállítás képernyőn be, vagy ki volt kapcsolva a szenzoros irányítás. Ehhez tartozik még egy <code>init</code> blokk, illetve egy függvény, amivel módosítani lehet ezt az állapotot. Az init blokk a következő képpen néz ki:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferenceStorage</span><span class="p">.</span><span class="na">isSensorControlled</span><span class="p">.</span><span class="na">collect</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">_isSensorControlled</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
Itt lényegében begyűjtjük a DataStore-ban tárolt adatot, jelen esetben a sensor be, vagy kikapcsolt állapotát, majd beállítja a lokális változó értékét.</p>
<p>Azonban szükségünk van még egy függvényre, aminek a segítségével tudjuk állítani ezt az állapotot.:</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">setSensorControlled</span><span class="p">(</span><span class="n">isSensorControlled</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">viewModelScope</span><span class="p">.</span><span class="na">launch</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">preferenceStorage</span><span class="p">.</span><span class="na">setSensorControlled</span><span class="p">(</span><span class="n">isSensorControlled</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Mivel egy suspend-ed függvényt szeretnénk meghívni, ezért ezt az egészet egy <code>viewModelScope.launch { .. }</code> blokkban kell ezt végrehajtani. Ezzel meg is van a SettingsViewModel, ezt már csak át kell adnunk a szükséges Composable függvények paramétereinek.</p>
<p>Szükség van arra hogy az alkalmazás tudja, hogy ezt a PreferenceStorage paramétert, hogyan állítsa elő, ehhez az AppModule-ban definiálnunk kell egy függvényt a következő képpen:</p>
<p><div class="highlight"><pre><span></span><code><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="n">SingletonComponent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">AppModule</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Singleton</span>
<span class="w">    </span><span class="nd">@Provides</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">providePreferenceStorage</span><span class="p">(</span><span class="nd">@ApplicationContext</span><span class="w"> </span><span class="n">context</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">):</span><span class="w"> </span><span class="n">PreferenceStorage</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">PreferenceStorage</span><span class="p">(</span><span class="n">context</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">//Other FUNS</span>
<span class="p">}</span>
</code></pre></div>
Ennek a segítségével elő fogja tudni állítani a szükséges paramétert az alkalmazásunk!</p>
<p>Ahhoz, hogy a SettingsScreen-en tudjuk használni ezt a viewModelt, vissza kell mennünk a MainActivity-be, és itt el kell végeznünk pár módosítást. Első sorban létre kell hoznunk egy settingsViewModel változót, amely a viewModel-t fogja példányosítani, majd be kell állítani az értékét, és átadni a MainNavScreennek:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@AndroidEntryPoint</span>
<span class="kd">class</span><span class="w"> </span><span class="nc">MainActivity</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ComponentActivity</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">lateinit</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">settingsViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span>
<span class="w">    </span><span class="c1">//Other Vals</span>

<span class="w">    </span><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">:</span><span class="w"> </span><span class="n">Bundle?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">super</span><span class="p">.</span><span class="na">onCreate</span><span class="p">(</span><span class="n">savedInstanceState</span><span class="p">)</span>

<span class="w">        </span><span class="n">settingsViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ViewModelProvider</span><span class="p">(</span><span class="k">this</span><span class="p">)</span><span class="o">[</span><span class="n">SettingsViewModel</span><span class="o">::</span><span class="n">class</span><span class="p">.</span><span class="na">java</span><span class="o">]</span>
<span class="w">        </span><span class="n">enableEdgeToEdge</span><span class="p">()</span>
<span class="w">        </span><span class="n">setContent</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SnakeDemoTestTheme</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">MainNavScreen</span><span class="p">(</span>
<span class="w">                    </span><span class="n">mainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mainViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">snakeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="p">,</span>
<span class="w">                    </span><span class="n">settingsViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settingsViewModel</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Itt még alá fogja húzni nekünk a meglévő kódot, ugyanis módosítanunk kell a MainNavScreen paraméterlistáját is, valamint a függvényhívást is.</p>
<div class="highlight"><pre><span></span><code><span class="nd">@OptIn</span><span class="p">(</span><span class="n">ExperimentalMaterial3Api</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">MainNavScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">settingsViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span>
<span class="p">){</span>

<span class="w">    </span><span class="c1">//...</span>

<span class="w">    </span><span class="n">Scaffold</span><span class="p">(</span>
<span class="w">        </span><span class="c1">//...</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">innerPadding</span><span class="w"> </span><span class="o">-&gt;</span>

<span class="w">        </span><span class="c1">//...</span>
<span class="w">        </span><span class="n">NavGraph</span><span class="p">(</span>
<span class="w">            </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">.</span><span class="na">padding</span><span class="p">(</span><span class="n">innerPadding</span><span class="p">),</span>
<span class="w">            </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">            </span><span class="n">snakeViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="p">,</span>
<span class="w">            </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">.</span><span class="na">value</span><span class="p">,</span>
<span class="w">            </span><span class="n">settingsVM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settingsViewModel</span>
<span class="w">        </span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Ezek után az error tovább került a NavGraph-ba, de továbbra sem vagyunk készen, és módosítjuk a NavGraph paraméter listáját is a következő képpen:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">NavGraph</span><span class="p">(</span>
<span class="w">    </span><span class="n">modifier</span><span class="p">:</span><span class="w"> </span><span class="n">Modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rememberNavController</span><span class="p">(),</span>
<span class="w">    </span><span class="n">startDestination</span><span class="p">:</span><span class="w"> </span><span class="kt">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;mainscreen&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">(),</span>
<span class="w">    </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">settingsVM</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div>
<p>Majd végül átadjuk az új <code>settingsVM</code> paramétert a SettingsScreen paraméterének:</p>
<div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span><span class="s">&quot;settings&quot;</span><span class="p">){</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">updateTitle</span><span class="p">(</span><span class="s">&quot;Settings&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">.</span><span class="na">setNavigationLambda</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">navController</span><span class="p">.</span><span class="na">navigate</span><span class="p">(</span><span class="s">&quot;mainscreen&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="n">SettingsScreen</span><span class="p">(</span><span class="n">settingsViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settingsVM</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ezek után nekiállhatunk a <code>SettingsScreen</code> módosításának. Mivel új paramétert kapott, egyből ezt fel is tudjuk használni egy változó inicializálására a következő képpen:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">SettingsScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">settingsViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">viewModel</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">settingsViewModel</span><span class="p">.</span><span class="na">isSensorControlled</span><span class="p">.</span><span class="na">collectAsState</span><span class="p">()</span>
<span class="w">    </span><span class="c1">//Column</span>
<span class="p">}</span>
</code></pre></div>
<p>Majd ezt az új változót használjuk tovább a Column egyes Composable függvényeiben paraméterként.:</p>
<p><div class="highlight"><pre><span></span><code><span class="n">Switch</span><span class="p">(</span>
<span class="w">    </span><span class="n">checked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isSensorControlled</span><span class="p">,</span>
<span class="w">    </span><span class="n">onCheckedChange</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">settingsViewModel</span><span class="p">.</span><span class="na">setSensorControlled</span><span class="p">(</span><span class="nb">it</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">)</span>
</code></pre></div>
Mivel az isSensorControlled egy val, ezért azt közvetlen nem tudjuk módosítani, hogy ha szükséges, így a settingsViewModel-ben lévő függvényt hívjuk, aminek a segítségével beállítjuk ezt a változót, és így a lokális val változónk is frissülni fog. Ha ezzel megvagyunk a kapcsolónak működnie kéne, és meg kéne tartania az állapotát, azonban még konkrét működés nincs hozzárendelve. Ezt a következő lépsekben tesszük meg.</p>
<p>Ahhoz, hogy magát a Sensor-t tudjuk használni, módosítanunk kell a SnakeViewModel-t úgy, hogy implementáljuk benne a <code>SensorEventListener</code> interface függvényeit. Ennek a segítségével adhatjuk meg, hogy milyen működést szeretnénk hozzárendelni az egyes Sensor műveletekhez. Ehhez nyissuk meg a már meglévő <code>SnakeViewModel</code> fájlunkat és módosítsuk a következőek szerint:</p>
<p><div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nc">SnakeViewModel</span><span class="w"> </span><span class="nd">@Inject</span><span class="w"> </span><span class="k">constructor</span><span class="p">(</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">topScoreDao</span><span class="p">:</span><span class="w"> </span><span class="n">TopScoreDao</span><span class="p">,</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">sensorManager</span><span class="p">:</span><span class="w"> </span><span class="n">SensorManager</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ViewModel</span><span class="p">(),</span><span class="w"> </span><span class="n">SensorEventListener</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//isTurned</span>

<span class="w">    </span><span class="c1">//Accelerometer</span>

<span class="w">    </span><span class="c1">//Is Sensor Controlled</span>

<span class="w">    </span><span class="c1">//Init</span>

<span class="w">    </span><span class="c1">//onSensorChanged</span>

<span class="w">    </span><span class="c1">//onAccuracyChanged</span>

<span class="p">}</span>
</code></pre></div>
Látható, hogy módosítottuk magát a paraméterét is, kapott egy SensorManager paramétert, amit később majd a Dependency Injectionnal fogunk átadni neki, amihez szükségünk van az <code>AppModule</code> módosítására, azonban ez még jelenleg Errort fog nekünk mutatni, ugyanis nem definiáltuk az interface függvényeit. Ehhez kattintsunk az aláhúzott piros részre, majd az <kbd>ALT</kbd>+<kbd>ENTER</kbd> segítségével hozzuk be a menüt, és kattintsunk az <em>Implement Members</em> opcióra, vagy írjuk bele a ViewModel-be az alábbi kódot:</p>
<div class="highlight"><pre><span></span><code><span class="c1">//...</span>
<span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onSensorChanged</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">SensorEvent?)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TODO</span><span class="p">(</span><span class="s">&quot;Not yet implemented&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onAccuracyChanged</span><span class="p">(</span><span class="n">sensor</span><span class="p">:</span><span class="w"> </span><span class="n">Sensor?,</span><span class="w"> </span><span class="n">accuracy</span><span class="p">:</span><span class="w"> </span><span class="kt">Int</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TODO</span><span class="p">(</span><span class="s">&quot;Not yet implemented&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">//...</span>
</code></pre></div>
<p>Nekünk az <code>onSensorChanged</code> függvényre lesz szükségünk, a másik függvény törzsét ki is törölhetjük! </p>
<div class="admonition danger">
<p class="admonition-title">TODO Comment</p>
<p><strong>Fontos, hogy töröljük ki a TODO commentet, mert nem fog működni az alkalmazás</strong></p>
</div>
<p>Mielőtt megcsinálnánk a függvényt, hozzunk létre pár új változót, erre azért lesz szükség, ugyanis akkor szeretnénk használni a Sensor-os érzékelőket, hogy ha az be van kapcsolva. Ehhez kell egy változó ami nyilván tartja ennek az állapotát, továbbá szükségünk van egy olyan változóra ami azt tartja nyilván, hogy a kígyóval lehet-e fordulni. Ezt azért kell beletennünk a kódban, ugyanis, ha gyorsan forgatjuk a telefont, és nem korlátozzuk a kígyó fordulását, akkor könnyen lehet, hogy GameOver-hez vezet a játék. (Kígyó előre megy, és 2x gyorsan fordulunk jobbra. Ilyenkor ha a kígyónak van már teste, saját magába fog ütközni, ezért korlátozzuk egy Boolean változóval a forgását.) Ezekhez a módosításokhoz, használjuk fel az alábbi kódot:</p>
<p><div class="highlight"><pre><span></span><code><span class="c1">//isTurned</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isTurned</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>

<span class="c1">//Accelerometer</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">var</span><span class="w"> </span><span class="nv">accelerometer</span><span class="p">:</span><span class="w"> </span><span class="n">Sensor? </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span>

<span class="c1">//Is Sensor Controlled</span>
<span class="kd">private</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="nv">_isSensorControlled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MutableStateFlow</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="kd">var</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="p">:</span><span class="w"> </span><span class="n">StateFlow</span><span class="o">&lt;</span><span class="kt">Boolean</span><span class="o">&gt;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_isSensorControlled</span><span class="p">.</span><span class="na">asStateFlow</span><span class="p">()</span>

<span class="c1">//Init</span>

<span class="k">init</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">accelerometer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sensorManager</span><span class="p">.</span><span class="na">getDefaultSensor</span><span class="p">(</span><span class="n">Sensor</span><span class="p">.</span><span class="na">TYPE_ACCELEROMETER</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
Jól látható, hogy a szükséges paramétereket megvalósítottuk, azonban egy init blokkra is szükségünk van, ugyanis a Sensor változót be kell regisztrálnunk minden egyes alkalommal. A következő lépésben az interface függvényét fogjuk megvalósítani.</p>
<p>Ebben a függvényben kell leírnunk, hogy melyik döntésre, milyen funkciót szeretnénk megvalósítani. Ehhez használjuk fel az alábbi kódot:</p>
<div class="highlight"><pre><span></span><code><span class="kd">override</span><span class="w"> </span><span class="kd">fun</span><span class="w"> </span><span class="nf">onSensorChanged</span><span class="p">(</span><span class="n">event</span><span class="p">:</span><span class="w"> </span><span class="n">SensorEvent?)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isSensorControlled</span><span class="p">.</span><span class="na">value</span><span class="p">)</span><span class="w"> </span><span class="k">return</span>

<span class="w">    </span><span class="n">event</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">values</span><span class="o">[</span><span class="m">0</span><span class="o">]</span>
<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">it</span><span class="p">.</span><span class="na">values</span><span class="o">[</span><span class="m">1</span><span class="o">]</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.0f</span>

<span class="w">        </span><span class="kd">val</span><span class="w"> </span><span class="nv">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">x</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">LEFT</span>
<span class="w">            </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">threshold</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">RIGHT</span>
<span class="w">            </span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">threshold</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">DOWN</span>
<span class="w">            </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="n">threshold</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Direction</span><span class="p">.</span><span class="na">UP</span>
<span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kc">null</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">direction</span><span class="o">?.</span><span class="na">let</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ChangeDir</span><span class="p">(</span><span class="nb">it</span><span class="p">))</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span>
<span class="p">}</span>
</code></pre></div>
<p>A függvény törzsében, hogy ha a sensorControll változónk hamis, akkor nem foglalkozunk a sensor állapotának módosulásával, ugyanis ilyenkor ki van kapcsolva és kézi irányítással irányítjuk a játékot. Azonban, hogy ha nem hamis, akkor tovább megyünk, és létrehozunk egy threshold változót, ami arra fog szolgállni, hogy ne legyen annyira érzékeny a sensoros irányítás, és kicsit jobban meg kelljen dönteni a képernyőt, hogy a kígyó forduljon. Ezután egy változót hozunk létre, amely a döntéstől függően egy irányt fog tartalmazni, amelyet utána felhasználunk egy onEvent paraméterként. Így fog megvalósulni a fordulása a kígyónak.</p>
<p>Továbbá szükségünk van egy olyan függvényre, amelynek a segítségével ki-be tudjuk kapcsolni az <code>_isSensorControlled</code> változónkat, illetve ki-be tudjuk regisztrálni a sensorManager változót. Ehhez használjuk fel az alábbi kódot, és értelmezzük!</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">setSensorControlled</span><span class="p">(</span><span class="n">enabled</span><span class="p">:</span><span class="w"> </span><span class="kt">Boolean</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_isSensorControlled</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">enabled</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">enabled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sensorManager</span><span class="p">.</span><span class="na">registerListener</span><span class="p">(</span><span class="k">this</span><span class="p">,</span><span class="w"> </span><span class="n">accelerometer</span><span class="p">,</span><span class="w"> </span><span class="n">SensorManager</span><span class="p">.</span><span class="na">SENSOR_DELAY_NORMAL</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sensorManager</span><span class="p">.</span><span class="na">unregisterListener</span><span class="p">(</span><span class="k">this</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>A függvény első sorában módosítjuk a változót, utána pedig egy if-else elágazás segítségével ki-be regisztráljuk a sensorManager-t, az állapottól függően.</p>
<p>Magát a függvényt a MainNavScreen-en szeretnénk meghívni úgy, hogy a settingsViewModel-ben eltárolt adatot adjuk át paraméterként a függvénynek. Ehhez használjuk fel a következő kódrészletet:</p>
<div class="highlight"><pre><span></span><code><span class="kd">fun</span><span class="w"> </span><span class="nf">MainNavScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">settingsViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeViewModel</span><span class="p">,</span>
<span class="w">    </span><span class="n">mainViewModel</span><span class="p">:</span><span class="w"> </span><span class="n">MainViewModel</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">settingsViewModel</span><span class="p">.</span><span class="na">isSensorControlled</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">()</span>
<span class="w">    </span><span class="n">snakeViewModel</span><span class="p">.</span><span class="na">setSensorControlled</span><span class="p">(</span><span class="n">isSensorControlled</span><span class="p">)</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">}</span>
</code></pre></div>
<p>Miután itt beállítottuk az alkalmazás be fogja regisztrálni a sensorManager-t, és ennek hatására tudjuk használni a Sensor-os irányítást. Azonban szükségünk van a UI módosítására a GameScreen-en, ugyanis azt szeretnénk elérni, hogy ha Sensoros irányításon vagyunk, akkor a UI ne tartalmazza a Controller gombokat, csak a játék állapot vezérlő gombokat. Ehhez módosítsuk a GameScreen-t a következő képpen:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Composable</span>
<span class="kd">fun</span><span class="w"> </span><span class="nf">GameScreen</span><span class="p">(</span>
<span class="w">    </span><span class="n">state</span><span class="p">:</span><span class="w"> </span><span class="n">SnakeState</span><span class="p">,</span>
<span class="w">    </span><span class="n">onEvent</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="kt">Unit</span><span class="p">,</span>
<span class="w">    </span><span class="n">navController</span><span class="p">:</span><span class="w"> </span><span class="n">NavHostController</span><span class="p">,</span>
<span class="w">    </span><span class="n">settingsVM</span><span class="p">:</span><span class="w"> </span><span class="n">SettingsViewModel</span><span class="p">,</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">val</span><span class="w"> </span><span class="nv">isSensorControlled</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">settingsVM</span><span class="p">.</span><span class="na">isSensorControlled</span><span class="p">.</span><span class="na">collectAsStateWithLifecycle</span><span class="p">()</span>

<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="c1">//Controllers</span>
<span class="p">}</span>
</code></pre></div>
<p>Ebben a Composable függvényben is szükségünk van a settingsViewModel paraméterre, ugyanis ennek a segítségével szedjük ki a Boolean változót, amely megmutatja, hogy Sensoros vagy Manuális irányítás UI-t kell használnunk. Ehhez módosítsuk a Controller UI részt, egy if-else elágazásra az alábbiak szerint:</p>
<p><div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isSensorControlled</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//Current Controllers under the Controllers Comment</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="p">{</span>
<span class="w">    </span><span class="c1">//Column ...</span>
<span class="p">}</span>
</code></pre></div>
Az else elágazás kitöltéséhez használjuk fel az alábbiakat:</p>
<p><strong>Column</strong></p>
<ul>
<li>Horizontal, Vertical - Center</li>
<li>Modifier<ul>
<li>1-es súlyozás (weight)</li>
<li>Töltse ki a teljes teret (fillMaxSize)</li>
<li>Háttér szürke legyen (background)</li>
<li>Legyen egy vékony kerete (border)
<div class="highlight"><pre><span></span><code><span class="n">Column</span><span class="p">(</span>
<span class="w">    </span><span class="n">horizontalAlignment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Alignment</span><span class="p">.</span><span class="na">CenterHorizontally</span><span class="p">,</span>
<span class="w">    </span><span class="n">verticalArrangement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrangement</span><span class="p">.</span><span class="na">Center</span><span class="p">,</span>
<span class="w">    </span><span class="n">modifier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Modifier</span>
<span class="w">        </span><span class="p">.</span><span class="na">weight</span><span class="p">(</span><span class="m">1f</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">background</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="na">Gray</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">fillMaxSize</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">border</span><span class="p">(</span><span class="m">1.</span><span class="n">dp</span><span class="p">,</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//TextButton 1</span>

<span class="w">    </span><span class="c1">//TextButton 2</span>

<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<p><strong>TextButton 1</strong></p>
<ul>
<li>OnClick<ul>
<li>GameState.IDLE -&gt; StartGame</li>
<li>GameState.STARTED -&gt; PauseGame</li>
<li>GameState.PAUSED -&gt; StartGame</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Töltse ki a teljes szélességet (fillMaxWidth)
<div class="highlight"><pre><span></span><code><span class="n">TextButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">gameState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">IDLE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="p">)</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">PauseGame</span><span class="p">)</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">StartGame</span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">gameState</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">IDLE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Start&quot;</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">STARTED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Pause&quot;</span>
<span class="w">            </span><span class="n">GameState</span><span class="p">.</span><span class="na">PAUSED</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="s">&quot;Resume&quot;</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span>
<span class="w">            </span><span class="n">Font</span><span class="p">(</span>
<span class="w">                </span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<p><strong>TextButton 2</strong></p>
<ul>
<li>OnClick:<ul>
<li>ResetGame</li>
</ul>
</li>
<li>Modifier:<ul>
<li>Töltse ki a tlejes szélességet (fillMaxWidth)
<div class="highlight"><pre><span></span><code><span class="n">TextButton</span><span class="p">(</span>
<span class="w">    </span><span class="n">onClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">onEvent</span><span class="p">(</span><span class="n">SnakeEvent</span><span class="p">.</span><span class="na">ResetGame</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="n">Modifier</span><span class="p">.</span><span class="na">fillMaxWidth</span><span class="p">()</span>
<span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Text</span><span class="p">(</span>
<span class="w">        </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="na">isGameOver</span><span class="p">)</span><span class="w"> </span><span class="s">&quot;Restart&quot;</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s">&quot;New Game&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30.</span><span class="n">sp</span><span class="p">,</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Color</span><span class="p">.</span><span class="na">Black</span><span class="p">,</span>
<span class="w">        </span><span class="n">fontFamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontFamily</span><span class="p">(</span>
<span class="w">            </span><span class="n">Font</span><span class="p">(</span>
<span class="w">                </span><span class="n">R</span><span class="p">.</span><span class="na">font</span><span class="p">.</span><span class="na">pixelfont</span><span class="p">,</span>
<span class="w">                </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FontStyle</span><span class="p">.</span><span class="na">Normal</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<p>Miután megvagyunk minden UI elemmel, már csak az <code>AppModule</code> bővítése, illetve a paraméterátadást kell megoldanunk. Ehhez használjuk fel a következő kódokat:</p>
<p><code>AppModule.kt</code></p>
<div class="highlight"><pre><span></span><code><span class="nd">@Module</span>
<span class="nd">@InstallIn</span><span class="p">(</span><span class="n">SingletonComponent</span><span class="o">::</span><span class="n">class</span><span class="p">)</span>
<span class="kd">object</span><span class="w"> </span><span class="nc">AppModule</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//Other FUNS</span>
<span class="w">    </span><span class="nd">@Provides</span>
<span class="w">    </span><span class="kd">fun</span><span class="w"> </span><span class="nf">provideSensorManager</span><span class="p">(</span><span class="nd">@ApplicationContext</span><span class="w"> </span><span class="n">context</span><span class="p">:</span><span class="w"> </span><span class="n">Context</span><span class="p">):</span><span class="w"> </span><span class="n">SensorManager</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getSystemService</span><span class="p">(</span><span class="n">Context</span><span class="p">.</span><span class="na">SENSOR_SERVICE</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">SensorManager</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Az alábbi függvénnyel megmondjuk az app-nak, hogy miként kell elkészítenie a SensorManager változót, és átadni a függvény paraméterének.</p>
<p><code>NavGraph.kt</code></p>
<div class="highlight"><pre><span></span><code><span class="n">composable</span><span class="p">(</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="p">){</span>
<span class="w">    </span><span class="c1">//...</span>
<span class="w">    </span><span class="n">GameScreen</span><span class="p">(</span>
<span class="w">        </span><span class="n">navController</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">navController</span><span class="p">,</span>
<span class="w">        </span><span class="n">state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state</span><span class="p">,</span>
<span class="w">        </span><span class="n">onEvent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">snakeViewModel</span><span class="o">::</span><span class="n">onEvent</span><span class="p">,</span>
<span class="w">        </span><span class="n">settingsVM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">settingsVM</span>
<span class="w">    </span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (2 pont)</p>
<p>Készíts <strong>képernyőképet</strong> az elkészült képernyőkről, amelyen látszik a <strong>Sensoros irányítás, és pár szerzett pont</strong> (emulátoron, készüléket tükrözve vagy képernyőfelvétellel), egy <strong>ahhoz tartozó kódrészlet</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f6.png néven töltsd föl.</p>
</div>
<h2 id="onallo-feladat-3-pont">Önálló feladat (3 pont)<a class="headerlink" href="#onallo-feladat-3-pont" title="Permanent link">&para;</a></h2>
<h3 id="high-score-delete-all-megvalositasa-1-pont">High Score Delete All megvalósítása (1 pont)<a class="headerlink" href="#high-score-delete-all-megvalositasa-1-pont" title="Permanent link">&para;</a></h3>
<p>Készítsd el a High Score képernyőn elhelyezkedő Delete All gomb működésének a logikáját!</p>
<details class="info">
<summary>Segítség</summary>
<ul>
<li>Dao függvény megvalósítása. <a href="https://developer.android.com/training/data-storage/room/accessing-data">HELP</a><ul>
<li>
<details class="info">
<summary>More Help</summary>
<div class="highlight"><pre><span></span><code>`DELETE FROM ...`
</code></pre></div>
</details>
</li>
</ul>
</li>
<li>SnakeViewModel függvény</li>
<li>OnClick esemény átadása</li>
</ul>
</details>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (1 pont)</p>
<p>Készíts <strong>egy képernyő képet</strong> az elkészült logikáról, amelyen látszik a <strong>kód, illetve egy olyan képernyő ahol van az adatbázisnak eleme, valamint egy olyan ahol a törölve vannak az elemek</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f7a.png, f7b.png néven töltsd föl.</p>
</div>
<h3 id="isturned-megvalositasa-1-pont">isTurned megvalósítása (1 pont)<a class="headerlink" href="#isturned-megvalositasa-1-pont" title="Permanent link">&para;</a></h3>
<p>Készítsd el az isTurned logikát, amely blokkolni fogja a fordulást, mindaddig amíg a kígyó nem ment egyet előre. Ehhez használjuk fel a létrehozott <code>_isTurned</code> változót. Működés:</p>
<ul>
<li>Fordulás után blokkoljuk az ismételt fordulást</li>
<li>Előre lépés után feloldjuk a blokkolást</li>
</ul>
<details class="info">
<summary>Segítség</summary>
<ol>
<li>Ha a változó IGAZ, akkor az onEvent - ChangeDir-ben visszatér érték módosítás nélkül.</li>
<li>Miután fordultunk egyet, a változó értékét IGAZ-ra állítjuk.</li>
<li>Miután lépett egyet előre a kígyó a változó értékét HAMIS-ra állítjuk.</li>
</ol>
</details>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (1 pont)</p>
<p>Készíts <strong>egy képernyő képet</strong> az elkészült logikáról, amelyen látszik a <strong>kód</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f8.png néven töltsd föl.</p>
</div>
<h3 id="egyetlen-elem-torlese-1-pont">Egyetlen elem törlése (1 pont)<a class="headerlink" href="#egyetlen-elem-torlese-1-pont" title="Permanent link">&para;</a></h3>
<p>Készítsd el azt a logikát, amellyel egyetlen elemet tudsz törölni az adatbázisból, hogy ha hosszan rányomsz az adott sorra a High Score Screenen!</p>
<details class="info">
<summary>Segítség</summary>
<ul>
<li>Hosszan nyomás kezelése - combinedClickable :)</li>
<li>Hasonlóan mint az első önálló feladat</li>
</ul>
</details>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ (1 pont)</p>
<p>Készíts <strong>két képernyő képet</strong> az elkészült logikáról, amelyen látszik az <strong>eredmény képernyő 3 adattal, majd utána kettő adattal</strong>, valamint a <strong>neptun kódod a kódban valahol kommentként</strong>. A képeket a megoldásban a repository-ba f9a.png, f9b.png néven töltsd föl.</p>
</div>

    <hr>
  <div class="md-source-file">
    <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
          </path>
        </svg>
      </span>
      <span title="2024. szeptember 24. 18:22:30">
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-09-24T18:22:30+02:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-09-24</span>
      </span>
    </span>

    

    <span class="md-source-file__fact">
      <span class="md-icon" title="Szerzők">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
          </path>
        </svg>
      </span>
      <span>Szerzők</span>
      <nav></nav>      
    </span>
  </div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Vissza a tetejére
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.instant", "navigation.top", "search.suggest"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>